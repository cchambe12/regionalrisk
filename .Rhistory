postcc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(alnglu.mat.postcc.onemat),
fs.2=quantile(alnglu.mat.postcc.onemat, 0.2), fs.98=quantile(alnglu.mat.postcc.onemat, 0.98))
alnglu.mat.precc <- rbind(alnglu.mat.precc, precc.df.here)
alnglu.mat.postcc <- rbind(alnglu.mat.postcc, postcc.df.here)
## BETPEN...
betpen.mat.precc.onemat <- (orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesBETPEN`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newmat[i])
betpen.mat.postcc.onemat <-(orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesBETPEN`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newmat[i])
precc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(betpen.mat.precc.onemat),
fs.2=quantile(betpen.mat.precc.onemat, 0.2), fs.98=quantile(betpen.mat.precc.onemat, 0.98))
postcc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(betpen.mat.postcc.onemat),
fs.2=quantile(betpen.mat.postcc.onemat, 0.2), fs.98=quantile(betpen.mat.postcc.onemat, 0.98))
betpen.mat.precc <- rbind(betpen.mat.precc, precc.df.here)
betpen.mat.postcc <- rbind(betpen.mat.postcc, postcc.df.here)
## FAGSYL...
fagsyl.mat.precc.onemat <- (orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFAGSYL`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newmat[i])
fagsyl.mat.postcc.onemat <-(orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFAGSYL`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newmat[i])
precc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(fagsyl.mat.precc.onemat),
fs.2=quantile(fagsyl.mat.precc.onemat, 0.2), fs.98=quantile(fagsyl.mat.precc.onemat, 0.98))
postcc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(fagsyl.mat.postcc.onemat),
fs.2=quantile(fagsyl.mat.postcc.onemat, 0.2), fs.98=quantile(fagsyl.mat.postcc.onemat, 0.98))
fagsyl.mat.precc <- rbind(fagsyl.mat.precc, precc.df.here)
fagsyl.mat.postcc <- rbind(fagsyl.mat.postcc, postcc.df.here)
## FRAEXC...
fraexc.mat.precc.onemat <- (orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFRAEXC`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newmat[i])
fraexc.mat.postcc.onemat <-(orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFRAEXC`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newmat[i])
precc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(fraexc.mat.precc.onemat),
fs.2=quantile(fraexc.mat.precc.onemat, 0.2), fs.98=quantile(fraexc.mat.precc.onemat, 0.98))
postcc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(fraexc.mat.postcc.onemat),
fs.2=quantile(fraexc.mat.postcc.onemat, 0.2), fs.98=quantile(fraexc.mat.postcc.onemat, 0.98))
fraexc.mat.precc <- rbind(fraexc.mat.precc, precc.df.here)
fraexc.mat.postcc <- rbind(fraexc.mat.postcc, postcc.df.here)
## QUEROB...
querob.mat.precc.onemat <- (orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesQUEROB`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newmat[i])
querob.mat.postcc.onemat <-(orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesQUEROB`)*newmat[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newmat[i])
precc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(querob.mat.precc.onemat),
fs.2=quantile(querob.mat.precc.onemat, 0.2), fs.98=quantile(querob.mat.precc.onemat, 0.98))
postcc.df.here <-  data.frame(mat=newmat[i], fs.mean=mean(querob.mat.postcc.onemat),
fs.2=quantile(querob.mat.postcc.onemat, 0.2), fs.98=quantile(querob.mat.postcc.onemat, 0.98))
querob.mat.precc <- rbind(querob.mat.precc, precc.df.here)
querob.mat.postcc <- rbind(querob.mat.postcc, postcc.df.here)
}
aeship.mat.postcc$cc <- "1"
aeship.mat.precc$cc <- "0"
aeship.mat <- rbind(aeship.mat.postcc, aeship.mat.precc)
aeship.mat$species <- "AESHIP"
alnglu.mat.postcc$cc <- "1"
alnglu.mat.precc$cc <- "0"
alnglu.mat <- rbind(alnglu.mat.postcc, alnglu.mat.precc)
alnglu.mat$species <- "ALNGLU"
betpen.mat.postcc$cc <- "1"
betpen.mat.precc$cc <- "0"
betpen.mat <- rbind(betpen.mat.postcc, betpen.mat.precc)
betpen.mat$species <- "aaBETPEN"
fagsyl.mat.postcc$cc <- "1"
fagsyl.mat.precc$cc <- "0"
fagsyl.mat <- rbind(fagsyl.mat.postcc, fagsyl.mat.precc)
fagsyl.mat$species <- "FAGSYL"
fraexc.mat.postcc$cc <- "1"
fraexc.mat.precc$cc <- "0"
fraexc.mat <- rbind(fraexc.mat.postcc, fraexc.mat.precc)
fraexc.mat$species <- "zFRAEXC"
querob.mat.postcc$cc <- "1"
querob.mat.precc$cc <- "0"
querob.mat <- rbind(querob.mat.postcc, querob.mat.precc)
querob.mat$species <- "QUEROB"
matxcc <- rbind(aeship.mat, alnglu.mat, betpen.mat, fagsyl.mat, fraexc.mat, querob.mat)
# To use any of these values we convert to log-odds scales
matxcc$fsmean_trans <- inverselogit(matxcc$fs.mean)
matxcc$fs2_trans <- inverselogit(matxcc$fs.2)
matxcc$fs98_trans <- inverselogit(matxcc$fs.98)
matxcc$mat_trans <- (matxcc$mat)*sd(bb$mst)*2 + mean(bb$mst)
matxcc$fsavg_sp <- ave(matxcc$fsmean_trans, matxcc$species, matxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
matxcc$fs_sp <- ave(matxcc$fs.mean, matxcc$species, matxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
matxcc$fsavg_all <- ave(matxcc$fsmean_trans, matxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
matxcc$fs_all <- ave(matxcc$fs.mean, matxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
matapc <- dplyr::select(matxcc, cc, species, fsavg_sp, fs_sp, fsavg_all, fs_all)
matapc <- matapc[!duplicated(matapc),]
#write.csv(matapc, file="~/Documents/git/regionalrisk/analyses/output/mat_apcoutput.csv", row.names=FALSE)
cols <-viridis_pal(option="viridis")(6)
meantemp <- ggplot(matxcc, aes(x=mat_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs2_trans, ymax=fs98_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("Mean Spring Temperature (Â°C)") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE) +
theme(legend.text.align = 0, plot.title = element_text(face="bold"),
legend.position="none") + ggtitle("(a)")
####################### Now for ELEVATION ###################
newelev <- seq(from=range(bb$elev.z)[1], to=range(bb$elev.z)[2], length.out=200)
### Repeat for each species... Now let's do the same thing but combine all into one loop
aeship.elev.precc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
aeship.elev.postcc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
alnglu.elev.precc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
alnglu.elev.postcc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
betpen.elev.precc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
betpen.elev.postcc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fagsyl.elev.precc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fagsyl.elev.postcc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fraexc.elev.precc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fraexc.elev.postcc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
querob.elev.precc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
querob.elev.postcc <- data.frame(elev=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
for(i in 1:length(newelev)){
## AESHIP here..
aeship.elev.precc.oneelev <- orig_sum$b_Intercept + orig_sum$b_elev.z*newelev[i] + orig_sum$b_cc.z*sort(unique(bb$cc.z))[1] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newelev[i])
aeship.elev.postcc.oneelev <-orig_sum$b_Intercept + orig_sum$b_elev.z*newelev[i] + orig_sum$b_cc.z*sort(unique(bb$cc.z))[2] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newelev[i])
precc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(aeship.elev.precc.oneelev),
fs.2=quantile(aeship.elev.precc.oneelev, 0.2), fs.98=quantile(aeship.elev.precc.oneelev, 0.98))
postcc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(aeship.elev.postcc.oneelev),
fs.2=quantile(aeship.elev.postcc.oneelev, 0.2), fs.98=quantile(aeship.elev.postcc.oneelev, 0.98))
aeship.elev.precc <- rbind(aeship.elev.precc, precc.df.here)
aeship.elev.postcc <- rbind(aeship.elev.postcc, postcc.df.here)
## ALNGLU...
alnglu.elev.precc.oneelev <- (orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newelev[i])
alnglu.elev.postcc.oneelev <-(orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newelev[i])
precc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(alnglu.elev.precc.oneelev),
fs.2=quantile(alnglu.elev.precc.oneelev, 0.2), fs.98=quantile(alnglu.elev.precc.oneelev, 0.98))
postcc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(alnglu.elev.postcc.oneelev),
fs.2=quantile(alnglu.elev.postcc.oneelev, 0.2), fs.98=quantile(alnglu.elev.postcc.oneelev, 0.98))
alnglu.elev.precc <- rbind(alnglu.elev.precc, precc.df.here)
alnglu.elev.postcc <- rbind(alnglu.elev.postcc, postcc.df.here)
## BETPEN...
betpen.elev.precc.oneelev <- (orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesBETPEN`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newelev[i])
betpen.elev.postcc.oneelev <-(orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesBETPEN`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newelev[i])
precc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(betpen.elev.precc.oneelev),
fs.2=quantile(betpen.elev.precc.oneelev, 0.2), fs.98=quantile(betpen.elev.precc.oneelev, 0.98))
postcc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(betpen.elev.postcc.oneelev),
fs.2=quantile(betpen.elev.postcc.oneelev, 0.2), fs.98=quantile(betpen.elev.postcc.oneelev, 0.98))
betpen.elev.precc <- rbind(betpen.elev.precc, precc.df.here)
betpen.elev.postcc <- rbind(betpen.elev.postcc, postcc.df.here)
## FAGSYL...
fagsyl.elev.precc.oneelev <- (orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFAGSYL`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newelev[i])
fagsyl.elev.postcc.oneelev <-(orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFAGSYL`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newelev[i])
precc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(fagsyl.elev.precc.oneelev),
fs.2=quantile(fagsyl.elev.precc.oneelev, 0.2), fs.98=quantile(fagsyl.elev.precc.oneelev, 0.98))
postcc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(fagsyl.elev.postcc.oneelev),
fs.2=quantile(fagsyl.elev.postcc.oneelev, 0.2), fs.98=quantile(fagsyl.elev.postcc.oneelev, 0.98))
fagsyl.elev.precc <- rbind(fagsyl.elev.precc, precc.df.here)
fagsyl.elev.postcc <- rbind(fagsyl.elev.postcc, postcc.df.here)
## FRAEXC...
fraexc.elev.precc.oneelev <- (orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFRAEXC`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newelev[i])
fraexc.elev.postcc.oneelev <-(orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFRAEXC`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newelev[i])
precc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(fraexc.elev.precc.oneelev),
fs.2=quantile(fraexc.elev.precc.oneelev, 0.2), fs.98=quantile(fraexc.elev.precc.oneelev, 0.98))
postcc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(fraexc.elev.postcc.oneelev),
fs.2=quantile(fraexc.elev.postcc.oneelev, 0.2), fs.98=quantile(fraexc.elev.postcc.oneelev, 0.98))
fraexc.elev.precc <- rbind(fraexc.elev.precc, precc.df.here)
fraexc.elev.postcc <- rbind(fraexc.elev.postcc, postcc.df.here)
## QUEROB...
querob.elev.precc.oneelev <- (orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesQUEROB`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newelev[i])
querob.elev.postcc.oneelev <-(orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesQUEROB`)*newelev[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newelev[i])
precc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(querob.elev.precc.oneelev),
fs.2=quantile(querob.elev.precc.oneelev, 0.2), fs.98=quantile(querob.elev.precc.oneelev, 0.98))
postcc.df.here <-  data.frame(elev=newelev[i], fs.mean=mean(querob.elev.postcc.oneelev),
fs.2=quantile(querob.elev.postcc.oneelev, 0.2), fs.98=quantile(querob.elev.postcc.oneelev, 0.98))
querob.elev.precc <- rbind(querob.elev.precc, precc.df.here)
querob.elev.postcc <- rbind(querob.elev.postcc, postcc.df.here)
}
aeship.elev.postcc$cc <- "1"
aeship.elev.precc$cc <- "0"
aeship.elev <- rbind(aeship.elev.postcc, aeship.elev.precc)
aeship.elev$species <- "AESHIP"
alnglu.elev.postcc$cc <- "1"
alnglu.elev.precc$cc <- "0"
alnglu.elev <- rbind(alnglu.elev.postcc, alnglu.elev.precc)
alnglu.elev$species <- "ALNGLU"
betpen.elev.postcc$cc <- "1"
betpen.elev.precc$cc <- "0"
betpen.elev <- rbind(betpen.elev.postcc, betpen.elev.precc)
betpen.elev$species <- "aaBETPEN"
fagsyl.elev.postcc$cc <- "1"
fagsyl.elev.precc$cc <- "0"
fagsyl.elev <- rbind(fagsyl.elev.postcc, fagsyl.elev.precc)
fagsyl.elev$species <- "FAGSYL"
fraexc.elev.postcc$cc <- "1"
fraexc.elev.precc$cc <- "0"
fraexc.elev <- rbind(fraexc.elev.postcc, fraexc.elev.precc)
fraexc.elev$species <- "zFRAEXC"
querob.elev.postcc$cc <- "1"
querob.elev.precc$cc <- "0"
querob.elev <- rbind(querob.elev.postcc, querob.elev.precc)
querob.elev$species <- "QUEROB"
elevxcc <- rbind(aeship.elev, alnglu.elev, betpen.elev, fagsyl.elev, fraexc.elev, querob.elev)
# To use any of these values we convert to log-odds scales
elevxcc$fsmean_trans <- inverselogit(elevxcc$fs.mean)
elevxcc$fs2_trans <- inverselogit(elevxcc$fs.2)
elevxcc$fs98_trans <- inverselogit(elevxcc$fs.98)
elevxcc$elev_trans <- (elevxcc$elev)*sd(bb$elev)*2 + mean(bb$elev)
elevxcc$fsavg_sp <- ave(elevxcc$fsmean_trans, elevxcc$species, elevxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
elevxcc$fs_sp <- ave(elevxcc$fs.mean, elevxcc$species, elevxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
elevxcc$fsavg_all <- ave(elevxcc$fsmean_trans, elevxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
elevxcc$fs_all <- ave(elevxcc$fs.mean, elevxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
elevapc <- dplyr::select(elevxcc, cc, species, fsavg_sp, fs_sp, fsavg_all, fs_all)
elevapc <- elevapc[!duplicated(elevapc),]
#write.csv(elevapc, file="~/Documents/git/regionalrisk/analyses/output/elev_apcoutput.csv", row.names=FALSE)
cols <-viridis_pal(option="viridis")(6)
elevations <- ggplot(elevxcc, aes(x=elev_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs2_trans, ymax=fs98_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("Elevation (m)") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE) +
theme(legend.text.align = 0, plot.title = element_text(face="bold"),
legend.position = "none") + ggtitle("(c)")
####################### Now for NAO ###################
newnao <- seq(from=range(bb$nao.z)[1], to=range(bb$nao.z)[2], length.out=200)
### Repeat for each species... Now let's do the same thing but combine all into one loop
aeship.nao.precc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
aeship.nao.postcc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
alnglu.nao.precc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
alnglu.nao.postcc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
betpen.nao.precc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
betpen.nao.postcc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fagsyl.nao.precc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fagsyl.nao.postcc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fraexc.nao.precc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
fraexc.nao.postcc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
querob.nao.precc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
querob.nao.postcc <- data.frame(nao=numeric(), fs.mean=numeric(), fs.2=numeric(), fs.98=numeric())
for(i in 1:length(newnao)){
## AESHIP here..
aeship.nao.precc.onenao <- orig_sum$b_Intercept + orig_sum$b_nao.z*newnao[i] + orig_sum$b_cc.z*sort(unique(bb$cc.z))[1] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newnao[i])
aeship.nao.postcc.onenao <-orig_sum$b_Intercept + orig_sum$b_nao.z*newnao[i] + orig_sum$b_cc.z*sort(unique(bb$cc.z))[2] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newnao[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(aeship.nao.precc.onenao),
fs.2=quantile(aeship.nao.precc.onenao, 0.2), fs.98=quantile(aeship.nao.precc.onenao, 0.98))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(aeship.nao.postcc.onenao),
fs.2=quantile(aeship.nao.postcc.onenao, 0.2), fs.98=quantile(aeship.nao.postcc.onenao, 0.98))
aeship.nao.precc <- rbind(aeship.nao.precc, precc.df.here)
aeship.nao.postcc <- rbind(aeship.nao.postcc, postcc.df.here)
## ALNGLU...
alnglu.nao.precc.onenao <- (orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newnao[i])
alnglu.nao.postcc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newnao[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(alnglu.nao.precc.onenao),
fs.2=quantile(alnglu.nao.precc.onenao, 0.2), fs.98=quantile(alnglu.nao.precc.onenao, 0.98))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(alnglu.nao.postcc.onenao),
fs.2=quantile(alnglu.nao.postcc.onenao, 0.2), fs.98=quantile(alnglu.nao.postcc.onenao, 0.98))
alnglu.nao.precc <- rbind(alnglu.nao.precc, precc.df.here)
alnglu.nao.postcc <- rbind(alnglu.nao.postcc, postcc.df.here)
## BETPEN...
betpen.nao.precc.onenao <- (orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesBETPEN`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newnao[i])
betpen.nao.postcc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesBETPEN`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newnao[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(betpen.nao.precc.onenao),
fs.2=quantile(betpen.nao.precc.onenao, 0.2), fs.98=quantile(betpen.nao.precc.onenao, 0.98))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(betpen.nao.postcc.onenao),
fs.2=quantile(betpen.nao.postcc.onenao, 0.2), fs.98=quantile(betpen.nao.postcc.onenao, 0.98))
betpen.nao.precc <- rbind(betpen.nao.precc, precc.df.here)
betpen.nao.postcc <- rbind(betpen.nao.postcc, postcc.df.here)
## FAGSYL...
fagsyl.nao.precc.onenao <- (orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFAGSYL`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newnao[i])
fagsyl.nao.postcc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFAGSYL`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newnao[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fagsyl.nao.precc.onenao),
fs.2=quantile(fagsyl.nao.precc.onenao, 0.2), fs.98=quantile(fagsyl.nao.precc.onenao, 0.98))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fagsyl.nao.postcc.onenao),
fs.2=quantile(fagsyl.nao.postcc.onenao, 0.2), fs.98=quantile(fagsyl.nao.postcc.onenao, 0.98))
fagsyl.nao.precc <- rbind(fagsyl.nao.precc, precc.df.here)
fagsyl.nao.postcc <- rbind(fagsyl.nao.postcc, postcc.df.here)
## FRAEXC...
fraexc.nao.precc.onenao <- (orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFRAEXC`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newnao[i])
fraexc.nao.postcc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFRAEXC`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newnao[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fraexc.nao.precc.onenao),
fs.2=quantile(fraexc.nao.precc.onenao, 0.2), fs.98=quantile(fraexc.nao.precc.onenao, 0.98))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fraexc.nao.postcc.onenao),
fs.2=quantile(fraexc.nao.postcc.onenao, 0.2), fs.98=quantile(fraexc.nao.postcc.onenao, 0.98))
fraexc.nao.precc <- rbind(fraexc.nao.precc, precc.df.here)
fraexc.nao.postcc <- rbind(fraexc.nao.postcc, postcc.df.here)
## QUEROB...
querob.nao.precc.onenao <- (orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesQUEROB`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newnao[i])
querob.nao.postcc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesQUEROB`)*newnao[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newnao[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(querob.nao.precc.onenao),
fs.2=quantile(querob.nao.precc.onenao, 0.2), fs.98=quantile(querob.nao.precc.onenao, 0.98))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(querob.nao.postcc.onenao),
fs.2=quantile(querob.nao.postcc.onenao, 0.2), fs.98=quantile(querob.nao.postcc.onenao, 0.98))
querob.nao.precc <- rbind(querob.nao.precc, precc.df.here)
querob.nao.postcc <- rbind(querob.nao.postcc, postcc.df.here)
}
aeship.nao.postcc$cc <- "1"
aeship.nao.precc$cc <- "0"
aeship.nao <- rbind(aeship.nao.postcc, aeship.nao.precc)
aeship.nao$species <- "AESHIP"
alnglu.nao.postcc$cc <- "1"
alnglu.nao.precc$cc <- "0"
alnglu.nao <- rbind(alnglu.nao.postcc, alnglu.nao.precc)
alnglu.nao$species <- "ALNGLU"
betpen.nao.postcc$cc <- "1"
betpen.nao.precc$cc <- "0"
betpen.nao <- rbind(betpen.nao.postcc, betpen.nao.precc)
betpen.nao$species <- "aaBETPEN"
fagsyl.nao.postcc$cc <- "1"
fagsyl.nao.precc$cc <- "0"
fagsyl.nao <- rbind(fagsyl.nao.postcc, fagsyl.nao.precc)
fagsyl.nao$species <- "FAGSYL"
fraexc.nao.postcc$cc <- "1"
fraexc.nao.precc$cc <- "0"
fraexc.nao <- rbind(fraexc.nao.postcc, fraexc.nao.precc)
fraexc.nao$species <- "zFRAEXC"
querob.nao.postcc$cc <- "1"
querob.nao.precc$cc <- "0"
querob.nao <- rbind(querob.nao.postcc, querob.nao.precc)
querob.nao$species <- "QUEROB"
naoxcc <- rbind(aeship.nao, alnglu.nao, betpen.nao, fagsyl.nao, fraexc.nao, querob.nao)
# To use any of these values we convert to log-odds scales
naoxcc$fsmean_trans <- inverselogit(naoxcc$fs.mean)
naoxcc$fs2_trans <- inverselogit(naoxcc$fs.2)
naoxcc$fs98_trans <- inverselogit(naoxcc$fs.98)
naoxcc$nao_trans <- (naoxcc$nao)*sd(bb$nao)*2 + mean(bb$nao)
naoxcc$fsavg_sp <- ave(naoxcc$fsmean_trans, naoxcc$species, naoxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
naoxcc$fs_sp <- ave(naoxcc$fs.mean, naoxcc$species, naoxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
naoxcc$fsavg_all <- ave(naoxcc$fsmean_trans, naoxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
naoxcc$fs_all <- ave(naoxcc$fs.mean, naoxcc$cc, FUN=function(x) mean(x, na.rm=TRUE))
naoapc <- dplyr::select(naoxcc, cc, species, fsavg_sp, fs_sp, fsavg_all, fs_all)
naoapc <- naoapc[!duplicated(naoapc),]
#write.csv(naoapc, file="~/Documents/git/regionalrisk/analyses/output/nao_apcoutput.csv", row.names=FALSE)
cols <-viridis_pal(option="viridis")(6)
naoindex <- ggplot(naoxcc, aes(x=nao_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs2_trans, ymax=fs98_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("NAO Index") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
ggtitle("(d)") +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, linetype=FALSE, alpha=FALSE) +
theme(legend.text.align = 0,
#legend.position = "none",
plot.title = element_text(face="bold"))
if(TRUE){
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
spplegend<-g_legend(naoindex)
#cclegend<-g_legend(naoindex)
}
naoindex <- ggplot(naoxcc, aes(x=nao_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs2_trans, ymax=fs98_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("NAO Index") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
ggtitle("(d)") +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, linetype=FALSE, alpha=FALSE) +
theme(legend.text.align = 0,
legend.position = "none",
plot.title = element_text(face="bold"))
quartz()
g1 <- grid.arrange(meantemp, distances, ncol=2)
g2 <- grid.arrange(elevations, naoindex, spplegend, ncol=3, widths=c(1, 1, 0.55))
grid.arrange(g1, g2, heights=c(2, 1.5))
png("~/Documents/git/regionalrisk/analyses/figures/APC_allpred_allspp_baseR_longtemps98.png",
width=8.5,
height=6, units="in", res = 350 )
grid.arrange(g1, g2, heights=c(2, 1.5))
dev.off()
-6.84+7.13
#load models and data to report numbers of things
options(stringsAsFactors = FALSE)
library(brms)
## Set Working Directory
setwd("~/Documents/git/regionalrisk")
load("longtemps_full.Rdata")
fstemps <- read.csv("analyses/output/fs_newspace_longtemps.csv", header=TRUE)
### Lastly, we calculate the longtemps model
mattemps<-round((mean(fixef(longtemps.full, pars="mat.z", summary=FALSE))/4)/(sd(fstemps$mst)*2)*100*2, digits=2) ## -11.56
naotemps<-round((mean(fixef(longtemps.full, pars="nao.z", summary=FALSE))/4)/(sd(fstemps$nao)*2)*100*0.3, digits=2) ## 1.26
disttemps<-round((mean(fixef(longtemps.full, pars="dist.z", summary=FALSE))/4)/(sd(fstemps$distkm)*2)*100*150, digits=2) ## 2.75
elevtemps<-round((mean(fixef(longtemps.full, pars="elev.z", summary=FALSE))/4)/(sd(fstemps$elev)*2)*100*200, digits=2) ## 7.35
cctemps<-round((mean(fixef(longtemps.full, pars="cc.z", summary=FALSE))/4)/(sd(fstemps$cc)*2)*100, digits=2) ## 14.55
alltempsccstand<-((mean(fixef(longtemps.full, pars="cc.z", summary=FALSE)))+(mean(fixef(longtemps.full, pars="cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="speciesALNGLU", summary=FALSE)))+(mean(fixef(longtemps.full, pars="cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="speciesBETPEN", summary=FALSE)))+(mean(fixef(longtemps.full, pars="cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="speciesFAGSYL", summary=FALSE)))+(mean(fixef(longtemps.full, pars="cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="speciesFRAEXC", summary=FALSE)))+(mean(fixef(longtemps.full, pars="cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="speciesQUEROB", summary=FALSE))))/6
alltempscc<-round((alltempsccstand/4)/(sd(fstemps$cc)*2)*100, digits=2)
mattempsz<-round((mean(fixef(fivelong.full, pars="mat.z", summary=FALSE))), digits=2)
naotempsz<-round((mean(fixef(fivelong.full, pars="nao.z", summary=FALSE))), digits=2)
mattempsz<-round((mean(fixef(longtemps.full, pars="mat.z", summary=FALSE))), digits=2)
naotempsz<-round((mean(fixef(longtemps.full, pars="nao.z", summary=FALSE))), digits=2)
disttempsz<-round((mean(fixef(longtemps.full, pars="dist.z", summary=FALSE))), digits=2)
elevtempsz<-round((mean(fixef(longtemps.full, pars="elev.z", summary=FALSE))), digits=2)
### And now for the interaction effects
naocctemps<-round((mean(fixef(longtemps.full, pars="nao.z", summary=FALSE))+mean(fixef(longtemps.full, pars="nao.z:cc.z", summary=FALSE))/4)/(sd(fstemps$nao)*2)*100*0.3, digits=2)
matcctemps<-round((mean(fixef(longtemps.full, pars="mat.z", summary=FALSE))+mean(fixef(longtemps.full, pars="mat.z:cc.z", summary=FALSE))/4)/(sd(fstemps$mat)*2)*100*2, digits=2)
distcctemps<-round((mean(fixef(longtemps.full, pars="dist.z", summary=FALSE))+mean(fixef(longtemps.full, pars="dist.z:cc.z", summary=FALSE))/4)/(sd(fstemps$distkm)*2)*100*150, digits=2)
elevcctemps<-round((mean(fixef(longtemps.full, pars="elev.z", summary=FALSE))+mean(fixef(longtemps.full, pars="elev.z:cc.z", summary=FALSE))/4)/(sd(fstemps$elev)*2)*100*200, digits=2)
mattempsccz<-round((mean(fixef(longtemps.full, pars="mat.z:cc.z", summary=FALSE))+mean(fixef(long.full, pars="mat.z", summary=FALSE))), digits=2)
naotempsccz<-round((mean(fixef(longtemps.full, pars="nao.z:cc.z", summary=FALSE))+mean(fixef(long.full, pars="nao.z", summary=FALSE))), digits=2)
mattempsccz<-round((mean(fixef(longtemps.full, pars="mat.z:cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="mat.z", summary=FALSE))), digits=2)
naotempsccz<-round((mean(fixef(longtemps.full, pars="nao.z:cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="nao.z", summary=FALSE))), digits=2)
disttempsccz<-round((mean(fixef(longtemps.full, pars="dist.z:cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="dist.z", summary=FALSE))), digits=2)
elevtempsccz<-round((mean(fixef(longtemps.full, pars="elev.z:cc.z", summary=FALSE))+mean(fixef(longtemps.full, pars="elev.z", summary=FALSE))), digits=2)
