theme(legend.text.align = 0, legend.position = c(0.75, 0.85), legend.background = element_rect(color="black")) + ggtitle("B.")
g1 <- grid.arrange(meantemp_sm, distances_sm, ncol=2)
g2 <- grid.arrange(elevations_sm, naoindex_sm, ncol=2, widths=c(1, 1))
grid.arrange(g1, g2, heights=c(2, 2), nrow=2)
naoindex_sm <- ggplot(naoxcc_sm, aes(x=nao_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs25_trans, ymax=fs75_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("NAO Index") +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, linetype=FALSE, alpha=FALSE) +
theme(legend.text.align = 0, legend.position=c(0.65, 0.85), legend.background = element_rect(color="black")) + ggtitle("D.")
g2 <- grid.arrange(elevations_sm, naoindex_sm, ncol=2, widths=c(1, 1))
grid.arrange(g1, g2, heights=c(2, 2), nrow=2)
distances_sm <- ggplot(distxcc_sm, aes(x=dist_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs25_trans, ymax=fs75_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("Distance from Coast (km)") +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, col=FALSE) +
theme(legend.text.align = 0, legend.position = c(0.80, 0.85), legend.background = element_rect(color="black")) + ggtitle("B.")
ean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs25_trans, ymax=fs75_trans, alp
naoindex_sm <- ggplot(naoxcc_sm, aes(x=nao_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs25_trans, ymax=fs75_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("NAO Index") +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, linetype=FALSE, alpha=FALSE) +
theme(legend.text.align = 0, legend.position=c(0.75, 0.85), legend.background = element_rect(color="black")) + ggtitle("D.")
g1 <- grid.arrange(meantemp_sm, distances_sm, ncol=2)
g2 <- grid.arrange(elevations_sm, naoindex_sm, ncol=2, widths=c(1, 1))
grid.arrange(g1, g2, heights=c(2, 2), nrow=2)
naoindex_sm <- ggplot(naoxcc_sm, aes(x=nao_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs25_trans, ymax=fs75_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("NAO Index") +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, linetype=FALSE, alpha=FALSE) +
theme(legend.text.align = 0, legend.position=c(0.80, 0.85), legend.background = element_rect(color="black")) + ggtitle("D.")
g2 <- grid.arrange(elevations_sm, naoindex_sm, ncol=2, widths=c(1, 1))
grid.arrange(g1, g2, heights=c(2, 2), nrow=2)
rm(list=ls())
options(stringsAsFactors = FALSE)
## Libraries
library(rstan)
library(brms)
library(ggplot2)
library(egg)
library(RColorBrewer)
library(sjmisc)
library(sjPlot)
library(ggeffects)
library(broom)
setwd("~/Documents/git/regionalrisk/analyses/output")
bb <- read.csv("analyses/output/fs_newspace_orig.csv", header=TRUE)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
##### Interaction Plots code
############################################################################
################### Original ##############################################
#naosp<- ggpredict(orig.full, terms = c("nao.z", "species"), ci.lvl=0.5)
#write.csv(naosp, file="~/Documents/git/regionalrisk/analyses/output/naosp_predicted.csv", row.names = FALSE)
#write.csv(naosp, file="~/Documents/git/regionalrisk/analyses/output/naosp_predicted_50.csv", row.names = FALSE)
naosp0<-read.csv("~/Documents/git/regionalrisk/analyses/output/naosp_predicted_90.csv", header=TRUE)
naosp0$group<-ifelse(naosp0$group=="BETPEN", "aaBETPEN", naosp0$group)
naosp0$group<-ifelse(naosp0$group=="FRAEXC", "zFRAEXC", naosp0$group)
naosp0$x <- (naosp0$x)*sd(bb$nao)*2 + mean(bb$nao)
naosp.p<-ggplot(naosp0, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("NAO") +
ylab("Probability of False Spring") + ggtitle("D.") + theme_classic() + theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
elevsp<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevsp_predicted_90.csv", header=TRUE)
elevsp$group<-ifelse(elevsp$group=="BETPEN", "aaBETPEN", elevsp$group)
elevsp$group<-ifelse(elevsp$group=="FRAEXC", "zFRAEXC", elevsp$group)
elevsp$x <- (elevsp$x)*sd(bb$elev)*2 + mean(bb$elev)
elevsp.p<-ggplot(elevsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Probability of False Spring") + ggtitle("C.") + theme_classic() + theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
matsp<-read.csv("~/Documents/git/regionalrisk/analyses/output/matsp_predicted_90.csv", header=TRUE)
matsp$group<-ifelse(matsp$group=="BETPEN", "aaBETPEN", matsp$group)
matsp$group<-ifelse(matsp$group=="FRAEXC", "zFRAEXC", matsp$group)
matsp$x <- (matsp$x)*sd(bb$mst)*2 + mean(bb$mst)
matsp.p<-ggplot(matsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Mean Spring Temperature") +
ylab("Probability of False Spring") + ggtitle("A.") + theme_classic()+ theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
spacesp<-read.csv("~/Documents/git/regionalrisk/analyses/output/spacesp_predicted_90.csv", header=TRUE)
spacesp$group<-ifelse(spacesp$group=="BETPEN", "aaBETPEN", spacesp$group)
spacesp$group<-ifelse(spacesp$group=="FRAEXC", "zFRAEXC", spacesp$group)
spacesp$x <- (spacesp$x)*sd(bb$distkm)*2 + mean(bb$distkm)
spacesp.p<-ggplot(spacesp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of False Spring") +
ggtitle("B.") + scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
theme_classic() + theme(legend.position = "none") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
ccsp<-read.csv("~/Documents/git/regionalrisk/analyses/output/ccsp_predicted_90.csv", header=TRUE)
ccsp$group<-ifelse(ccsp$group=="BETPEN", "aaBETPEN", ccsp$group)
ccsp$group<-ifelse(ccsp$group=="FRAEXC", "zFRAEXC", ccsp$group)
ccsp$x <- (ccsp$x)*sd(bb$cc)*2 + mean(bb$cc)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  +
theme_classic() + #theme(legend.position = "none") +
#theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  +
theme_classic() + theme(legend.position = "none") +
#theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
quartz()
g1<-grid.arrange(matsp.p, spacesp.p, mylegend, ncol=3, widths=c(1.5, 1.5, 1))
g2<-grid.arrange(elevsp.p, naosp.p, ccsp.p, ncol=3, widths=c(1,1,1))
#spacesp<- ggpredict(orig.full, terms = c("dist.z", "species"), ci.lvl = 0.5)
#write.csv(spacesp, file="~/Documents/git/regionalrisk/analyses/output/spacesp_predicted.csv", row.names = FALSE)
#write.csv(spacesp, file="~/Documents/git/regionalrisk/analyses/output/spacesp_predicted_50.csv", row.names = FALSE)
spacesp<-read.csv("~/Documents/git/regionalrisk/analyses/output/distsp_predicted_90.csv", header=TRUE)
spacesp$group<-ifelse(spacesp$group=="BETPEN", "aaBETPEN", spacesp$group)
spacesp$group<-ifelse(spacesp$group=="FRAEXC", "zFRAEXC", spacesp$group)
spacesp$x <- (spacesp$x)*sd(bb$distkm)*2 + mean(bb$distkm)
spacesp.p<-ggplot(spacesp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of False Spring") +
ggtitle("B.") + scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
theme_classic() + theme(legend.position = "none") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g1<-grid.arrange(matsp.p, spacesp.p, mylegend, ncol=3, widths=c(1.5, 1.5, 1))
g2<-grid.arrange(elevsp.p, naosp.p, ccsp.p, ncol=3, widths=c(1,1,1))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
naosp.p<-ggplot(naosp0, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("NAO Index") +
ylab("Probability of False Spring") + ggtitle("D.") + theme_classic() + theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
elevsp.p<-ggplot(elevsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Elevation (m)") +
ylab("Probability of False Spring") + ggtitle("C.") + theme_classic() + theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
matsp.p<-ggplot(matsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Mean Spring Temperature (°C)") +
ylab("Probability of False Spring") + ggtitle("A.") + theme_classic()+ theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
spacesp.p<-ggplot(spacesp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Distance from Coast (km)") + ylab("Probability of False Spring") +
ggtitle("B.") + scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1)) +
theme_classic() + theme(legend.position = "none") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  +
theme_classic() + #theme(legend.position = "none") +
theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) + guides(fill=FALSE)
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  +
theme_classic() + theme(legend.position = "none") +
theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) + guides(fill=FALSE)
g1<-grid.arrange(matsp.p, spacesp.p, mylegend, ncol=3, widths=c(1.5, 1.5, 1))
g2<-grid.arrange(elevsp.p, naosp.p, ccsp.p, ncol=3, widths=c(1,1,1))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
theme_classic() + #theme(legend.position = "none") +
theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) + guides(fill=FALSE)
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  + theme(legend.key = element_rect(fill="transparent"))
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  + theme(legend.key = element_rect(fill="transparent")) +
theme_classic() + #theme(legend.position = "none") +
theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) + guides(fill=FALSE)
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  + theme(legend.key = element_rect(fill="transparent")) +
theme_classic() + theme(legend.position = "none") +
theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) + guides(fill=FALSE)
g1<-grid.arrange(matsp.p, spacesp.p, mylegend, ncol=3, widths=c(1.5, 1.5, 1))
g2<-grid.arrange(elevsp.p, naosp.p, ccsp.p, ncol=3, widths=c(1,1,1))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  + theme(legend.key = element_rect(fill="transparent")) +
theme_classic() + #theme(legend.position = "none") +
theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high, col=group, fill=group), linetype=0, alpha=0.4) +
coord_cartesian(ylim=c(0,1))  + theme(legend.key = element_rect(fill="transparent")) +
theme_classic() + theme(legend.position = "none") +
theme(legend.text.align = 0) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g1<-grid.arrange(matsp.p, spacesp.p, mylegend, ncol=3, widths=c(1.5, 1.5, 1))
g2<-grid.arrange(elevsp.p, naosp.p, ccsp.p, ncol=3, widths=c(1,1,1))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
bb <- read.csv("fs_newspace_orig.csv", header=TRUE)
setwd("~/Documents/git/regionalrisk")
load("orig_full.Rdata")
load("orig_full_fagus.Rdata")
orig.full
orig.full.fagus
