all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
all_mat
colnames(me.elev)
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=0,1)
all_dist
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_dist
colnames(me.elev)
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_nao
all_elev <- ggplot(me.species, aes(x=elev, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Mean Spring Temperature") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_elev <- ggplot(me.species, aes(x=elev, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("C.")
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Mean Spring Temperature") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("A.")
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("B.")
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("D.")
grid.arrange(all_mat, all_dist, all_elev, all_nao, ncol=2, nrow=2, heights=c(2, 1.5),
widths=c(2, 1.5))
library(egg)
grid.arrange(all_mat, all_dist, all_elev, all_nao, ncol=2, nrow=2, heights=c(2, 1.5),
widths=c(2, 1.5))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(all_nao)
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position="none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("D.")
quartz()
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, ncol=2, nrow=2, heights=c(2, 1.5),
layout_matrix=rbind(c(2, 2),
c(1, 1, 1)))
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, ncol=3, nrow=2, heights=c(2, 1.5),
layout_matrix=rbind(c(2, 2),
c(1, 1, 1)))
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, heights=c(2, 1.5),
layout_matrix=rbind(c(2, NA, 2),
c(1, 1, 1)))
ndata <- 1000
agri <- rnorm(ndata, 0, 10)
cc <- rnorm(ndata, 0, 1)
ba <- -0.5
bc <- 0.5
a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
0.433774 + -0.038109*mean(agri)
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
int = -0.829
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz(-0.45496, agri) ## -10.12255
agri.z <- (agri-mean(agri,na.rm=TRUE))/(2*sd(agri,na.rm=TRUE))
#### Using Gelman-Hill method
invlogit <- function(x) {(1/(1+exp(-(x))))}
ndata <- 1000
agri <- rnorm(ndata, 0, 10)
cc <- rnorm(ndata, 0, 1)
ba <- -0.5
bc <- 0.5
a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
0.433774 + -0.038109*mean(agri)
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
int = -0.829
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz(-0.45496, agri) ## -10.12255
agri.z <- (agri-mean(agri,na.rm=TRUE))/(2*sd(agri,na.rm=TRUE))
cc.z <- (cc-mean(cc,na.rm=TRUE))/(2*sd(cc,na.rm=TRUE))
m2 <- glm(y ~ agri.z + cc.z + agri.z:cc.z, family = "binomial")
int = -0.8653
testz <- function(coef, pred) {(invlogit(int + (coef/(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef/(sd(pred)*2))*(mean(pred)-1)))*100}
testz <- function(coef, pred) {(invlogit( + (coef*(sd(pred)*2)+mean(pred))*mean(pred)) -
invlogit(int + (coef*(sd(pred)*2)+mean(pred))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -10.13641
testz <- function(coef, pred) {(invlogit( + (coef*(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef*(sd(pred)*2))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
testz <- function(coef, pred) {(invlogit( + (coef/(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef/(sd(pred)*2))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
testz <- function(coef, pred) {(invlogit(int + (coef*(sd(pred)*2))*mean(pred)) -
invlogit(int + (coef*(sd(pred)*2))*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
mean(pred)
pred=agri
mean(pred)
range(pred)
coef*(sd(pred)*2)
(coef*(sd(pred)*2))
coef=-8.715
(coef*(sd(pred)*2))
(invlogit(int + (coef*(sd(pred)*2))*mean(pred))
)
div4 = coef/4
div4
testz <- function(coef, pred) {(invlogit(int + coef*mean(pred))) -
invlogit(int + (coef*(mean(pred)-1)))*100}
testz(-8.715, agri) ## -100
pred=agri.z
testz <- function(coef, pred) {(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1)))}
zpred <- testz(-8.715, agri) ##
zpred
pred=agri
div4 = coef/4 #-2.17875
testz <- function(coef, pred) {(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1)))}
zpred <- testz(-8.715, agri) ##
zpred
(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1))
)
testz <- function(coef, pred) {(int + coef*mean(pred)) - (int + (coef*(mean(pred)-1)))}
testz(-8.715, agri) ## -100
int + coef*mean(pred)
int + (coef*(mean(pred)-1)
)
ndata <- 1000
agri <- rnorm(ndata, 0, 10)
cc <- rnorm(ndata, 0, 1)
ba <- -0.5
bc <- 0.5
a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
0.433774 + -0.038109*mean(agri)
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
int = -0.829
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz(-0.45496, agri) ## -10.22591
-0.45496/4
m0
-0.038109/4
#### Now try and make fake data to really tease this apart and test
set.seed(1234)
ndata <- 1000
agri <- rnorm(ndata, 0, 10)
cc <- rnorm(ndata, 0, 1)
ba <- -0.5
bc <- 0.5
a <- -1
z <- a + ba*agri + bc*cc
p <- 1/(1+exp(-z))
y <- rbinom(ndata, 1, p)
m0 <- lm(y ~ agri + cc + agri + agri:cc)
m0
m1 <- glm(y ~ agri + cc +agri:cc, family = "binomial")
m1
coef(m1)
coef(m1)[1]
(coef(m1)[2])/4
int = coef(m1)[1]
testnonz <- function(coef, pred) {(invlogit(int + coef*mean(pred)) -
invlogit(int + coef*(mean(pred)-1)))*100}
testnonz((coef(m1)[2]), agri) ## -9.922911
summary(m1)
install.packages("geosphere")
load("~/Documents/git/regionalrisk/orig_full.Rdata")
load("~/Documents/git/regionalrisk/dvr_full.Rdata")
load("~/Documents/git/regionalrisk/five_full.Rdata")
View(orig.full)
orig.full
dvr.full
five.full
library(bayesplot)
mcmc_neff(orig.full)
neff_ratio(orig.full)
ratios <- neff_ratio(orig.full)
mcmc_neff(ratios, size = 3)
light <- ratios[(ratios<1.05),]
light <- ratios[(ratios<1.05)]
med <- ratios[(ratios>1.05 & ratios<1.1)]
dark <- ratios[(ratios>1.1)]
### Same rule but for DVR:
(mean(fixef(dvr.full, pars="mat.z", summary=FALSE))/4)/(sd(fs$mst)*2)*100*2 ## -7.638351 (vs -3.331)
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(brms)
## Set Working Directory
setwd("~/Documents/git/regionalrisk")
load("orig_full.Rdata")
load("dvr_full.Rdata")
fs <- read.csv("analyses/output/fs_newspace_orig.csv", header=TRUE)
#### Using Gelman-Hill method
invlogit <- function(x) {(1/(1+exp(-(x))))}
### Same rule but for DVR:
(mean(fixef(dvr.full, pars="mat.z", summary=FALSE))/4)/(sd(fs$mst)*2)*100*2 ## -7.638351 (vs -3.331)
(mean(fixef(dvr.full, pars="nao.z", summary=FALSE))/4)/(sd(fs$nao)*2)*100*0.3 ## 1.915104 (vs 1.54)
(mean(fixef(dvr.full, pars="dist.z", summary=FALSE))/4)/(sd(fs$distkm)*2)*100*150 ## 5.320474 (vs 4.83)
(mean(fixef(dvr.full, pars="elev.z", summary=FALSE))/4)/(sd(fs$elev)*2)*100*200 ## 2.235522 (vs 1.89)
(mean(fixef(dvr.full, pars="cc.z", summary=FALSE))/4)/(sd(fs$cc)*2)*100 ## 8.842486 (vs 7.225)
### Same rule but for Five model:
(mean(fixef(five.full, pars="mat.z", summary=FALSE))/4)/(sd(fs$mst)*2)*100*2 ## -8.078
load("five_full.Rdata")
### Same rule but for Five model:
(mean(fixef(five.full, pars="mat.z", summary=FALSE))/4)/(sd(fs$mst)*2)*100*2 ## -8.078
(mean(fixef(five.full, pars="nao.z", summary=FALSE))/4)/(sd(fs$nao)*2)*100*0.3 ## 2.04
(mean(fixef(five.full, pars="dist.z", summary=FALSE))/4)/(sd(fs$distkm)*2)*100*150 ## 5.36
(mean(fixef(five.full, pars="elev.z", summary=FALSE))/4)/(sd(fs$elev)*2)*100*200 ## 1.77
(mean(fixef(five.full, pars="cc.z", summary=FALSE))/4)/(sd(fs$cc)*2)*100 ## 8.6
five.full
dvr.full
orig.full
