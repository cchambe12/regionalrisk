library(rstan)
library(brms)
library(ggplot2)
library(egg)
library(RColorBrewer)
setwd("~/Documents/git/regionalrisk")
load("orig_full.Rdata")
bb <- read.csv("analyses/output/fs_newspace_orig.csv", header=TRUE)
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$nao.z <- (bb$nao-mean(bb$nao,na.rm=TRUE))/(2*sd(bb$nao,na.rm=TRUE))
bb$mat.z <- (bb$mst-mean(bb$mst,na.rm=TRUE))/(2*sd(bb$mst,na.rm=TRUE))
bb$cc.z <- (bb$cc-mean(bb$cc,na.rm=TRUE))/(2*sd(bb$cc,na.rm=TRUE))
bb$elev.z <- (bb$elev-mean(bb$elev,na.rm=TRUE))/(2*sd(bb$elev,na.rm=TRUE))
bb$lat.z <- (bb$lat-mean(bb$lat,na.rm=TRUE))/(2*sd(bb$lat,na.rm=TRUE))
bb$dist.z <-(bb$distkm-mean(bb$distkm,na.rm=TRUE))/(2*sd(bb$distkm,na.rm=TRUE))
bb$space.z <-(bb$eigen-mean(bb$eigen,na.rm=TRUE))/(2*sd(bb$eigen,na.rm=TRUE))
##############################
## Start of Lizzie's new code
##############################
## Let's just check out the model
sort(unique(bb$species))
summary(orig.full)
orig_sum <- posterior_samples(orig.full)
View(orig_sum)
#################################################################################
############################ Let's check out CC #################################
#################################################################################
newcc <- seq(from=range(bb$cc.z)[1], to=range(bb$cc.z)[2], length.out=200)
lstfrz <- read.csv("analyses/output/lastfreezedates.csv")
head(lstfrz)
lstfrz$diff <- lstfrz$lastfreeze - lstfrz$lastfreezemax
range(lstfrz$diff)
newcc <- seq(from=range(bb$cc.z)[1], to=range(bb$cc.z)[2], length.out=200)
### Repeat for each species... Now let's do the same thing but combine all into one loop
aeship.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
aeship.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
alnglu.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
alnglu.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
betpen.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
betpen.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fagsyl.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fagsyl.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fraexc.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fraexc.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
querob.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
querob.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
for(i in 1:length(newcc)){
## AESHIP here..
aeship.cc.precc.onecc <- orig_sum$b_Intercept + orig_sum$b_dist.z*newcc[i] + orig_sum$b_dist.z:cc.z*sort(unique(bb$cc.z))[1] +
orig_sum[["b_cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
orig_sum$b_elev.z*newcc[i] + orig_sum$b_elev.z:cc.z*sort(unique(bb$cc.z))[1] +
orig_sum$b_nao.z*newcc[i] + orig_sum$b_nao.z:cc.z*sort(unique(bb$cc.z))[1] +
orig_sum$b_mat.z*newcc[i] + orig_sum$b_mat.z:cc.z*sort(unique(bb$cc.z))[1]
aeship.cc.postcc.onecc <-orig_sum$b_Intercept + orig_sum$b_dist.z*newcc[i] + orig_sum$b_dist.z:cc.z*sort(unique(bb$cc.z))[2] +
orig_sum[["b_cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
orig_sum$b_elev.z*newcc[i] + orig_sum$b_elev.z:cc.z*sort(unique(bb$cc.z))[2] +
orig_sum$b_nao.z*newcc[i] + orig_sum$b_nao.z:cc.z*sort(unique(bb$cc.z))[2] +
orig_sum$b_mat.z*newcc[i] + orig_sum$b_mat.z:cc.z*sort(unique(bb$cc.z))[2]
precc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(aeship.cc.precc.onecc),
fs.25=quantile(aeship.cc.precc.onecc, 0.25), fs.75=quantile(aeship.cc.precc.onecc, 0.75))
postcc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(aeship.cc.postcc.onecc),
fs.25=quantile(aeship.cc.postcc.onecc, 0.25), fs.75=quantile(aeship.cc.postcc.onecc, 0.75))
aeship.cc.precc <- rbind(aeship.cc.precc, precc.df.here)
aeship.cc.postcc <- rbind(aeship.cc.postcc, postcc.df.here)
## ALNGLU...
alnglu.cc.precc.onecc <- (orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesALNGLU`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
alnglu.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesALNGLU`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(alnglu.cc.precc.onecc),
fs.25=quantile(alnglu.cc.precc.onecc, 0.25), fs.75=quantile(alnglu.cc.precc.onecc, 0.75))
postcc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(alnglu.cc.postcc.onecc),
fs.25=quantile(alnglu.cc.postcc.onecc, 0.25), fs.75=quantile(alnglu.cc.postcc.onecc, 0.75))
alnglu.cc.precc <- rbind(alnglu.cc.precc, precc.df.here)
alnglu.cc.postcc <- rbind(alnglu.cc.postcc, postcc.df.here)
## BETPEN...
betpen.cc.precc.onecc <- (orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesBETPEN`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
betpen.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesBETPEN`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(betpen.nao.precc.onenao),
fs.25=quantile(betpen.nao.precc.onenao, 0.25), fs.75=quantile(betpen.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(betpen.nao.postcc.onenao),
fs.25=quantile(betpen.nao.postcc.onenao, 0.25), fs.75=quantile(betpen.nao.postcc.onenao, 0.75))
betpen.nao.precc <- rbind(betpen.nao.precc, precc.df.here)
betpen.nao.postcc <- rbind(betpen.nao.postcc, postcc.df.here)
## FAGSYL...
fagsyl.nao.precc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFAGSYL`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
fagsyl.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFAGSYL`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fagsyl.nao.precc.onenao),
fs.25=quantile(fagsyl.nao.precc.onenao, 0.25), fs.75=quantile(fagsyl.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fagsyl.nao.postcc.onenao),
fs.25=quantile(fagsyl.nao.postcc.onenao, 0.25), fs.75=quantile(fagsyl.nao.postcc.onenao, 0.75))
fagsyl.nao.precc <- rbind(fagsyl.nao.precc, precc.df.here)
fagsyl.nao.postcc <- rbind(fagsyl.nao.postcc, postcc.df.here)
## FRAEXC...
fraexc.nao.precc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFRAEXC`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
fraexc.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFRAEXC`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fraexc.nao.precc.onenao),
fs.25=quantile(fraexc.nao.precc.onenao, 0.25), fs.75=quantile(fraexc.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fraexc.nao.postcc.onenao),
fs.25=quantile(fraexc.nao.postcc.onenao, 0.25), fs.75=quantile(fraexc.nao.postcc.onenao, 0.75))
fraexc.nao.precc <- rbind(fraexc.nao.precc, precc.df.here)
fraexc.nao.postcc <- rbind(fraexc.nao.postcc, postcc.df.here)
## QUEROB...
querob.nao.precc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesQUEROB`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
querob.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesQUEROB`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(querob.nao.precc.onenao),
fs.25=quantile(querob.nao.precc.onenao, 0.25), fs.75=quantile(querob.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(querob.nao.postcc.onenao),
fs.25=quantile(querob.nao.postcc.onenao, 0.25), fs.75=quantile(querob.nao.postcc.onenao, 0.75))
querob.nao.precc <- rbind(querob.nao.precc, precc.df.here)
querob.nao.postcc <- rbind(querob.nao.postcc, postcc.df.here)
}
aeship.cc.postcc$cc <- "1"
aeship.cc.precc$cc <- "0"
aeship.cc <- rbind(aeship.cc.postcc, aeship.cc.precc)
aeship.cc$species <- "AESHIP"
alnglu.cc.postcc$cc <- "1"
alnglu.cc.precc$cc <- "0"
alnglu.cc <- rbind(alnglu.cc.postcc, alnglu.cc.precc)
alnglu.cc$species <- "ALNGLU"
betpen.cc.postcc$cc <- "1"
betpen.cc.precc$cc <- "0"
betpen.cc <- rbind(betpen.cc.postcc, betpen.cc.precc)
betpen.cc$species <- "aaBETPEN"
fagsyl.cc.postcc$cc <- "1"
fagsyl.cc.precc$cc <- "0"
fagsyl.cc <- rbind(fagsyl.cc.postcc, fagsyl.cc.precc)
fagsyl.cc$species <- "FAGSYL"
fraexc.cc.postcc$cc <- "1"
fraexc.cc.precc$cc <- "0"
fraexc.cc <- rbind(fraexc.cc.postcc, fraexc.cc.precc)
fraexc.cc$species <- "zFRAEXC"
querob.cc.postcc$cc <- "1"
querob.cc.precc$cc <- "0"
querob.cc <- rbind(querob.cc.postcc, querob.cc.precc)
querob.cc$species <- "QUEROB"
ccxcc <- rbind(aeship.cc, alnglu.cc, betpen.cc, fagsyl.cc, fraexc.cc, querob.cc)
# To use any of these values we convert to log-odds scales
ccxcc$fsmean_trans <- inverselogit(ccxcc$fs.mean)
ccxcc$fs25_trans <- inverselogit(ccxcc$fs.25)
ccxcc$fs75_trans <- inverselogit(ccxcc$fs.75)
ccxcc$cc_trans <- (ccxcc$cc)*sd(bb$mst)*2 + mean(bb$mst)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
quartz()
ccindex <- ggplot(ccxcc, aes(x=cc_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs25_trans, ymax=fs75_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("Climate Change") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, linetype=FALSE, alpha=FALSE) +
theme(legend.text.align = 0, legend.position = "none") + ggtitle("E.")
ccindex
### Repeat for each species... Now let's do the same thing but combine all into one loop
aeship.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
aeship.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
alnglu.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
alnglu.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
betpen.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
betpen.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fagsyl.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fagsyl.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fraexc.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
fraexc.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
querob.cc.precc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
querob.cc.postcc <- data.frame(cc=numeric(), fs.mean=numeric(), fs.25=numeric(), fs.75=numeric())
1=2
i=2
## AESHIP here..
aeship.cc.precc.onecc <- orig_sum$b_Intercept + orig_sum$b_dist.z*newcc[i] + orig_sum$b_dist.z:cc.z*sort(unique(bb$cc.z))[1] +
orig_sum[["b_cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
orig_sum$b_elev.z*newcc[i] + orig_sum$b_elev.z:cc.z*sort(unique(bb$cc.z))[1] +
orig_sum$b_nao.z*newcc[i] + orig_sum$b_nao.z:cc.z*sort(unique(bb$cc.z))[1] +
orig_sum$b_mat.z*newcc[i] + orig_sum$b_mat.z:cc.z*sort(unique(bb$cc.z))[1]
aeship.cc.precc.onecc
aeship.cc.precc.onecc
View(aeship.cc.postcc)
orig_sum$b_Intercept
orig_sum$b_dist.z*newcc[i]
orig_sum$b_dist.z:cc.z*sort(unique(bb$cc.z))[1]
orig_sum$`b_dist.z:cc.z`*sort(unique(bb$cc.z))[1]
orig_sum[["b_cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
## ALNGLU...
alnglu.cc.precc.onecc <- (orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesALNGLU`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
alnglu.cc.precc.onecc
alnglu.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesALNGLU`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
alnglu.cc.postcc.onecc
precc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(alnglu.cc.precc.onecc),
fs.25=quantile(alnglu.cc.precc.onecc, 0.25), fs.75=quantile(alnglu.cc.precc.onecc, 0.75))
postcc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(alnglu.cc.postcc.onecc),
fs.25=quantile(alnglu.cc.postcc.onecc, 0.25), fs.75=quantile(alnglu.cc.postcc.onecc, 0.75))
alnglu.cc.precc <- rbind(alnglu.cc.precc, precc.df.here)
alnglu.cc.postcc <- rbind(alnglu.cc.postcc, postcc.df.here)
for(i in 1:length(newcc)){ #i=2
## AESHIP here..
aeship.cc.precc.onecc <- orig_sum$b_Intercept + orig_sum$b_dist.z*newcc[i] + orig_sum$`b_dist.z:cc.z`*sort(unique(bb$cc.z))[1] +
orig_sum[["b_cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
orig_sum$b_elev.z*newcc[i] + orig_sum$`b_elev.z:cc.z`*sort(unique(bb$cc.z))[1] +
orig_sum$b_nao.z*newcc[i] + orig_sum$`b_nao.z:cc.z`*sort(unique(bb$cc.z))[1] +
orig_sum$b_mat.z*newcc[i] + orig_sum$`b_mat.z:cc.z`*sort(unique(bb$cc.z))[1]
aeship.cc.postcc.onecc <-orig_sum$b_Intercept + orig_sum$b_dist.z*newcc[i] + orig_sum$`b_dist.z:cc.z`*sort(unique(bb$cc.z))[2] +
orig_sum[["b_cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
orig_sum$b_elev.z*newcc[i] + orig_sum$`b_elev.z:cc.z`*sort(unique(bb$cc.z))[2] +
orig_sum$b_nao.z*newcc[i] + orig_sum$`b_nao.z:cc.z`*sort(unique(bb$cc.z))[2] +
orig_sum$b_mat.z*newcc[i] + orig_sum$`b_mat.z:cc.z`*sort(unique(bb$cc.z))[2]
precc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(aeship.cc.precc.onecc),
fs.25=quantile(aeship.cc.precc.onecc, 0.25), fs.75=quantile(aeship.cc.precc.onecc, 0.75))
postcc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(aeship.cc.postcc.onecc),
fs.25=quantile(aeship.cc.postcc.onecc, 0.25), fs.75=quantile(aeship.cc.postcc.onecc, 0.75))
aeship.cc.precc <- rbind(aeship.cc.precc, precc.df.here)
aeship.cc.postcc <- rbind(aeship.cc.postcc, postcc.df.here)
## ALNGLU...
alnglu.cc.precc.onecc <- (orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesALNGLU`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
alnglu.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesALNGLU) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesALNGLU`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesALNGLU`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesALNGLU`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(alnglu.cc.precc.onecc),
fs.25=quantile(alnglu.cc.precc.onecc, 0.25), fs.75=quantile(alnglu.cc.precc.onecc, 0.75))
postcc.df.here <-  data.frame(cc=newcc[i], fs.mean=mean(alnglu.cc.postcc.onecc),
fs.25=quantile(alnglu.cc.postcc.onecc, 0.25), fs.75=quantile(alnglu.cc.postcc.onecc, 0.75))
alnglu.cc.precc <- rbind(alnglu.cc.precc, precc.df.here)
alnglu.cc.postcc <- rbind(alnglu.cc.postcc, postcc.df.here)
## BETPEN...
betpen.cc.precc.onecc <- (orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesBETPEN`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
betpen.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesBETPEN) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesBETPEN`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesBETPEN`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesBETPEN`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(betpen.nao.precc.onenao),
fs.25=quantile(betpen.nao.precc.onenao, 0.25), fs.75=quantile(betpen.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(betpen.nao.postcc.onenao),
fs.25=quantile(betpen.nao.postcc.onenao, 0.25), fs.75=quantile(betpen.nao.postcc.onenao, 0.75))
betpen.nao.precc <- rbind(betpen.nao.precc, precc.df.here)
betpen.nao.postcc <- rbind(betpen.nao.postcc, postcc.df.here)
## FAGSYL...
fagsyl.nao.precc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFAGSYL`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
fagsyl.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesFAGSYL) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFAGSYL`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFAGSYL`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fagsyl.nao.precc.onenao),
fs.25=quantile(fagsyl.nao.precc.onenao, 0.25), fs.75=quantile(fagsyl.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fagsyl.nao.postcc.onenao),
fs.25=quantile(fagsyl.nao.postcc.onenao, 0.25), fs.75=quantile(fagsyl.nao.postcc.onenao, 0.75))
fagsyl.nao.precc <- rbind(fagsyl.nao.precc, precc.df.here)
fagsyl.nao.postcc <- rbind(fagsyl.nao.postcc, postcc.df.here)
## FRAEXC...
fraexc.nao.precc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFRAEXC`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFRAEXC`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
fraexc.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesFRAEXC) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesFRAEXC`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesFAGSYL`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesFRAEXC`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fraexc.nao.precc.onenao),
fs.25=quantile(fraexc.nao.precc.onenao, 0.25), fs.75=quantile(fraexc.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(fraexc.nao.postcc.onenao),
fs.25=quantile(fraexc.nao.postcc.onenao, 0.25), fs.75=quantile(fraexc.nao.postcc.onenao, 0.75))
fraexc.nao.precc <- rbind(fraexc.nao.precc, precc.df.here)
fraexc.nao.postcc <- rbind(fraexc.nao.postcc, postcc.df.here)
## QUEROB...
querob.nao.precc.onenao <-(orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesQUEROB`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[1] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[1]*newcc[i])
querob.cc.postcc.onecc <-(orig_sum$b_Intercept + orig_sum$b_speciesQUEROB) + (orig_sum$b_dist.z + orig_sum$`b_dist.z:speciesQUEROB`)*newcc[i] +
(orig_sum$b_cc.z + orig_sum$`b_cc.z:speciesQUEROB`)*sort(unique(bb$cc.z))[2] +
orig_sum[["b_dist.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_elev.z + orig_sum$`b_elev.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_elev.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_mat.z + orig_sum$`b_mat.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_mat.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i]) +
(orig_sum$b_nao.z + orig_sum$`b_nao.z:speciesQUEROB`)*newcc[i] +
orig_sum[["b_nao.z:cc.z"]]*(sort(unique(bb$cc.z))[2]*newcc[i])
precc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(querob.nao.precc.onenao),
fs.25=quantile(querob.nao.precc.onenao, 0.25), fs.75=quantile(querob.nao.precc.onenao, 0.75))
postcc.df.here <-  data.frame(nao=newnao[i], fs.mean=mean(querob.nao.postcc.onenao),
fs.25=quantile(querob.nao.postcc.onenao, 0.25), fs.75=quantile(querob.nao.postcc.onenao, 0.75))
querob.nao.precc <- rbind(querob.nao.precc, precc.df.here)
querob.nao.postcc <- rbind(querob.nao.postcc, postcc.df.here)
}
aeship.cc.postcc$cc <- "1"
aeship.cc.precc$cc <- "0"
aeship.cc <- rbind(aeship.cc.postcc, aeship.cc.precc)
aeship.cc$species <- "AESHIP"
alnglu.cc.postcc$cc <- "1"
alnglu.cc.precc$cc <- "0"
alnglu.cc <- rbind(alnglu.cc.postcc, alnglu.cc.precc)
alnglu.cc$species <- "ALNGLU"
betpen.cc.postcc$cc <- "1"
betpen.cc.precc$cc <- "0"
betpen.cc <- rbind(betpen.cc.postcc, betpen.cc.precc)
betpen.cc$species <- "aaBETPEN"
fagsyl.cc.postcc$cc <- "1"
fagsyl.cc.precc$cc <- "0"
fagsyl.cc <- rbind(fagsyl.cc.postcc, fagsyl.cc.precc)
fagsyl.cc$species <- "FAGSYL"
fraexc.cc.postcc$cc <- "1"
fraexc.cc.precc$cc <- "0"
fraexc.cc <- rbind(fraexc.cc.postcc, fraexc.cc.precc)
fraexc.cc$species <- "zFRAEXC"
querob.cc.postcc$cc <- "1"
querob.cc.precc$cc <- "0"
querob.cc <- rbind(querob.cc.postcc, querob.cc.precc)
querob.cc$species <- "QUEROB"
ccxcc <- rbind(aeship.cc, alnglu.cc, betpen.cc, fagsyl.cc, fraexc.cc, querob.cc)
# To use any of these values we convert to log-odds scales
ccxcc$fsmean_trans <- inverselogit(ccxcc$fs.mean)
ccxcc$fs25_trans <- inverselogit(ccxcc$fs.25)
ccxcc$fs75_trans <- inverselogit(ccxcc$fs.75)
ccxcc$cc_trans <- (ccxcc$cc)*sd(bb$mst)*2 + mean(bb$mst)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
quartz()
ccindex <- ggplot(ccxcc, aes(x=cc_trans, y=fsmean_trans)) + geom_line(aes(linetype=cc, alpha=cc, col=species)) +
geom_ribbon(aes(ymin=fs25_trans, ymax=fs75_trans, alpha=cc, fill=species)) + theme_classic() +
scale_linetype_manual(name="Climate Change", values=c("dashed", "solid"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
scale_alpha_manual(name="Climate Change", values=c(0.3, 1),
labels=c("0"="1950-1983",
"1"="1984-2016")) + xlab("Climate Change") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
ylab("Probability of False Spring") + coord_cartesian(ylim = c(0, 1), expand=c(0, 0)) + guides(fill=FALSE, linetype=FALSE, alpha=FALSE) +
theme(legend.text.align = 0, legend.position = "none") + ggtitle("E.")
ccindex
View(ccxcc)
aeship.cc.precc.onecc
aeship.cc.postcc.onecc
(sort(unique(bb$cc.z))[2]
)
(sort(unique(bb$cc.z))[1])
ccsp<- ggpredict(orig.full, terms = c("cc.z", "species"), ci.lvl=0.5)
ccsp
