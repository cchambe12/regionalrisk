stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=0,1)
all_dist
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_dist
colnames(me.elev)
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_nao
all_elev <- ggplot(me.species, aes(x=elev, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Mean Spring Temperature") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_elev <- ggplot(me.species, aes(x=elev, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("C.")
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Mean Spring Temperature") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("A.")
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("B.")
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("D.")
grid.arrange(all_mat, all_dist, all_elev, all_nao, ncol=2, nrow=2, heights=c(2, 1.5),
widths=c(2, 1.5))
library(egg)
grid.arrange(all_mat, all_dist, all_elev, all_nao, ncol=2, nrow=2, heights=c(2, 1.5),
widths=c(2, 1.5))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(all_nao)
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position="none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("D.")
quartz()
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, ncol=2, nrow=2, heights=c(2, 1.5),
layout_matrix=rbind(c(2, 2),
c(1, 1, 1)))
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, ncol=3, nrow=2, heights=c(2, 1.5),
layout_matrix=rbind(c(2, 2),
c(1, 1, 1)))
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, heights=c(2, 1.5),
layout_matrix=rbind(c(2, NA, 2),
c(1, 1, 1)))
rm(list=ls())
options(stringsAsFactors = FALSE)
## Libraries
library(ggplot2)
library(dplyr)
library(egg)
library(RColorBrewer)
library(maptools)
setwd("~/Documents/git/regionalrisk")
bb <- read.csv("analyses/output/fs_newspace_orig.csv", header=TRUE)
### Now let's try and make those maps..
fsbefore <- bb[(bb$cc==0),]
fsbefore$meanfspre <- ave(fsbefore$fs, fsbefore$lat.long, fsbefore$species)
fsbefore <- subset(fsbefore, select=c("lat", "long", "meanfspre", "species"))
fsbefore <- fsbefore[!duplicated(fsbefore),]
fsafter <- bb[(bb$cc==1),]
fsafter$meanfspost <- ave(fsafter$fs, fsafter$lat.long, fsafter$species)
fsafter <- subset(fsafter, select=c("lat", "long", "meanfspost", "species"))
fsafter <- fsafter[!duplicated(fsafter),]
fsboth <- full_join (fsbefore, fsafter)
fsboth$diff <- fsboth$meanfspre - fsboth$meanfspost
fsboth <- fsboth[!is.na(fsboth$diff),]
#Using GGPLOT, plot the Base World Map
mapWorld <- borders("world", colour="gray72", fill="gray65",ylim=c(30,70),xlim=c(-10,35)) # create a layer of borders
myPalette <- colorRampPalette(c("red", "blue"))
a.site <- fsboth #[!(site$meanfspre==0 & site$meanfspost==0),]
a.site <- subset(a.site, select=c("lat", "long", "diff", "species"))
#a.site<-filter(site, species=="AESHIP")
boundars<-readShapeSpatial("~/Documents/git/regionalrisk/analyses/input/natural_earth_vector/50m_cultural/ne_50m_admin_0_countries.shp")
mapWorld<-fortify(boundars)
#a.site$color <- ifelse(a.site$diff < 0, "red", "blue")
a.site <- a.site[!is.na(a.site$diff),]
aes <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +  ### This creates the base map
geom_polygon(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) + theme_classic() + ### this removes extra background features from ggplot2
#geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat), size=0.8, alpha=0.4) +
scale_fill_gradient(low = "red", high = "blue", na.value=NA) +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+  ### zooms in on Europe
theme(panel.border = element_blank(), ### extra tweaks to background and plot to make sure it doesn't have grid lines, etc.
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) + ### to make sure the continent doesn't blend in with the ocean
annotate("text",label= "Aesculus \nhippocastanum", col="#CAB1C4", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + #sc +
#scale_color_manual(values=c("red"="red", "blue"="blue"), labels=c("red" = "More freezes after 1984",
#                                                    "blue" = "Fewer freezes after 1984")) +
labs(color="Difference in \nday of budburst") + ggtitle("")
aes
a.site <- fsboth [!(site$meanfspre==0 & site$meanfspost==0),]
site <- fsboth[(fsboth$diff<=0.3 | fsboth$diff>0.3),]
a.site <- fsboth [!(site$meanfspre==0 & site$meanfspost==0),]
site <- fsboth[(fsboth$diff<=0.3 | fsboth$diff>0.3),]
a.site <- site [!(site$meanfspre==0 & site$meanfspost==0),]
a.site <- subset(a.site, select=c("lat", "long", "diff", "species"))
#a.site$color <- ifelse(a.site$diff < 0, "red", "blue")
a.site <- a.site[!is.na(a.site$diff),]
aes <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +  ### This creates the base map
geom_polygon(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) + theme_classic() + ### this removes extra background features from ggplot2
#geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat), size=0.8, alpha=0.4) +
scale_fill_gradient(low = "red", high = "blue", na.value=NA) +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+  ### zooms in on Europe
theme(panel.border = element_blank(), ### extra tweaks to background and plot to make sure it doesn't have grid lines, etc.
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) + ### to make sure the continent doesn't blend in with the ocean
annotate("text",label= "Aesculus \nhippocastanum", col="#CAB1C4", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + #sc +
#scale_color_manual(values=c("red"="red", "blue"="blue"), labels=c("red" = "More freezes after 1984",
#                                                    "blue" = "Fewer freezes after 1984")) +
labs(color="Difference in \nday of budburst") + ggtitle("")
aes
aes <- ggplot() + # data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +  ### This creates the base map
#geom_polygon(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +  ### this removes extra background features from ggplot2
geom_tile(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +
#geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat), size=0.8, alpha=0.4) + scale_size_area() + ## add in a.site$diff + 1
scale_fill_gradient(low = "red", high = "blue", na.value=NA) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+  ### zooms in on Europe
theme(panel.border = element_blank(), ### extra tweaks to background and plot to make sure it doesn't have grid lines, etc.
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) + ### to make sure the continent doesn't blend in with the ocean
annotate("text",label= "Aesculus \nhippocastanum", col="#CAB1C4", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + #sc +
#scale_color_manual(values=c("red"="red", "blue"="blue"), labels=c("red" = "More freezes after 1984",
#                                                    "blue" = "Fewer freezes after 1984")) +
labs(color="Difference in \nday of budburst") + ggtitle("")
aes
aes <- ggplot() + # data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +  ### This creates the base map
#geom_polygon(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +  ### this removes extra background features from ggplot2
#geom_tile(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +
geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat), size=0.8, alpha=0.4) + scale_size_area() + ## add in a.site$diff + 1
scale_fill_gradient(low = "red", high = "blue", na.value=NA) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+  ### zooms in on Europe
theme(panel.border = element_blank(), ### extra tweaks to background and plot to make sure it doesn't have grid lines, etc.
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) + ### to make sure the continent doesn't blend in with the ocean
annotate("text",label= "Aesculus \nhippocastanum", col="#CAB1C4", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + #sc +
#scale_color_manual(values=c("red"="red", "blue"="blue"), labels=c("red" = "More freezes after 1984",
#                                                    "blue" = "Fewer freezes after 1984")) +
labs(color="Difference in \nday of budburst") + ggtitle("")
aes
aes <- ggplot() + # data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +  ### This creates the base map
#geom_polygon(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +  ### this removes extra background features from ggplot2
#geom_tile(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +
geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat, fill=a.site$diff), alpha=0.4) + scale_size_area() + ## add in a.site$diff + 1
scale_fill_gradient(low = "red", high = "blue", na.value=NA) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+  ### zooms in on Europe
theme(panel.border = element_blank(), ### extra tweaks to background and plot to make sure it doesn't have grid lines, etc.
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) + ### to make sure the continent doesn't blend in with the ocean
annotate("text",label= "Aesculus \nhippocastanum", col="#CAB1C4", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + #sc +
#scale_color_manual(values=c("red"="red", "blue"="blue"), labels=c("red" = "More freezes after 1984",
#                                                    "blue" = "Fewer freezes after 1984")) +
labs(color="Difference in \nday of budburst") + ggtitle("")
aes
aes <- ggplot() + # data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +  ### This creates the base map
#geom_polygon(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +  ### this removes extra background features from ggplot2
#geom_tile(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +
geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat, color=a.site$diff), alpha=0.4) + scale_size_area() + ## add in a.site$diff + 1
scale_color_gradient(low = "red", high = "blue", na.value=NA) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+  ### zooms in on Europe
theme(panel.border = element_blank(), ### extra tweaks to background and plot to make sure it doesn't have grid lines, etc.
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) + ### to make sure the continent doesn't blend in with the ocean
annotate("text",label= "Aesculus \nhippocastanum", col="#CAB1C4", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + #sc +
#scale_color_manual(values=c("red"="red", "blue"="blue"), labels=c("red" = "More freezes after 1984",
#                                                    "blue" = "Fewer freezes after 1984")) +
labs(color="Difference in \nday of budburst") + ggtitle("")
aes
a.site$diff <- a.site$diff + 1
aes <- ggplot() + # data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +  ### This creates the base map
#geom_polygon(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +  ### this removes extra background features from ggplot2
#geom_tile(data=a.site, aes(x=a.site$long, y=a.site$lat, fill=a.site$diff)) +
geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat, color=a.site$diff), alpha=0.4) + scale_size_area() + ## add in a.site$diff + 1
scale_color_gradient(low = "red", high = "blue", na.value=NA) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+  ### zooms in on Europe
theme(panel.border = element_blank(), ### extra tweaks to background and plot to make sure it doesn't have grid lines, etc.
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) + ### to make sure the continent doesn't blend in with the ocean
annotate("text",label= "Aesculus \nhippocastanum", col="#CAB1C4", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + #sc +
#scale_color_manual(values=c("red"="red", "blue"="blue"), labels=c("red" = "More freezes after 1984",
#                                                    "blue" = "Fewer freezes after 1984")) +
labs(color="Difference in \nday of budburst") + ggtitle("")
aes
