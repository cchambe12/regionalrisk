fake <- vector()
for (i in 1:length(ntot)){
coeff <- c(child[i],
rnorm(1, sunnydiff, sunnydiff.sd)
)
dp <- rnorm(n = length(sunny), mean = mm %*% coeff, sd = 5)
fake <- data.frame(dp=dp, sunny=sunny)
}
hist(fake$dp[sunny==1])
hist(fake$dp[sunny==2])
mean(fake$dp) # 50.5
sd(fake$dp) # 7.24
display(lm(dp~sunny, data=fake))
#lm(formula = dp ~ sunny, data = fake)
#coef.est coef.se
#(Intercept) 45.33     0.23
#sunny2      10.25     0.32
#---
#  n = 1000, k = 2
#residual sd = 5.11, R-Squared = 0.50
### Alright, now let's triple the effect size...
### Sunny D increases the level of dopamine to 75 ng/ml - we'll keep the sample size the same
nsunny.e = 2
rep.e = 50
ntot.e = nsunny.e*rep.e
sunny.e = gl(nsunny.e, rep.e, length=ntot.e)
sunnydiff.e = 30
sunnydiff.sd.e = 0
suns.e<-rnorm(ntot.e, 75, 5)
base.e <- 45
child.e <- base.e + suns.e-mean(suns.e)
mm.e <- model.matrix(~(sunny.e)^2, data.frame=(sunny.e))
fake.e <- vector()
for (i in 1:length(ntot.e)){
coeff.e <- c(child.e[i],
rnorm(1, sunnydiff.e, sunnydiff.sd.e)
)
dp.e <- rnorm(n = length(sunny.e), mean = mm.e %*% coeff.e, sd = 5)
fake.e <- data.frame(dp.e=dp.e, sunny.e=sunny.e)
}
hist(fake.e$dp.e[sunny.e==1])
hist(fake.e$dp.e[sunny.e==2])
mean(fake.e$dp.e) # 61.2
sd(fake.e$dp.e) # 15.9
display(lm(dp.e~sunny.e, data=fake.e))
#lm(formula = dp.e ~ sunny.e, data = fake.e)
#coef.est coef.se
#(Intercept) 46.04     0.22
#sunny.e2    30.24     0.31
#---
#  n = 1000, k = 2
#residual sd = 4.94, R-Squared = 0.90
## And now, we triple the sample size...
nsunny.s = 2
rep.s = 150
ntot.s = nsunny.s*rep.s
sunny.s = gl(nsunny.s, rep.s, length=ntot.s)
sunnydiff.s = 10
sunnydiff.sd.s = 0
suns.s<-rnorm(ntot.s, 55, 5)
base.s <- 45
child.s <- base.s + suns.s-mean(suns.s)
mm.s <- model.matrix(~(sunny.s)^2, data.frame=(sunny.s))
fake.s <- vector()
for (i in 1:length(ntot.s)){
coeff.s <- c(child.s[i],
rnorm(1, sunnydiff.s, sunnydiff.sd.s)
)
dp.s <- rnorm(n = length(sunny.s), mean = mm.s %*% coeff.s, sd = 5)
fake.s <- data.frame(dp.s=dp.s, sunny.s=sunny.s)
}
hist(fake.s$dp.s)
mean(fake.s$dp.s) # 52.8
sd(fake.s$dp.s) # 6.93
display(lm(dp.s~sunny.s, data=fake.s))
#lm(formula = dp.s ~ sunny.s, data = fake.s)
#coef.est coef.se
#(Intercept) 48.01     0.13
#sunny.s2     9.66     0.18
#---
#  n = 3000, k = 2
#residual sd = 4.97, R-Squared = 0.49
#### Let's plot the effects!
fake$sunny<-ifelse(fake$sunny==1, "control", "sunnyD")
base<- qplot(sunny, dp, data = fake, geom="boxplot", color=sunny) +
xlab("Sunny D consumption") + ylab("Dopamine levels (ng/ml)") + ylim(30,85)
fake.e$sunny.e<-ifelse(fake.e$sunny.e==1, "control", "sunnyD")
effect<- qplot(sunny.e, dp.e, data = fake.e, geom="boxplot", color=sunny.e) +
xlab("Sunny D consumption") + ylab("Dopamine levels (ng/ml)") + ylim(30,85)
fake.s$sunny.s<-ifelse(fake.s$sunny.s==1, "control", "sunnyD")
sample<- qplot(sunny.s, dp.s, data = fake.s, geom="boxplot", color=sunny.s) +
xlab("Sunny D consumption") + ylab("Dopamine levels (ng/ml)") + ylim(30,85)
grid.arrange(base, effect, sample, ncol=3, nrow=1)
fake$child<- as.numeric(sample(100))
fake.e$child.e<-as.numeric(sample(100))
fake.s$child.s<-as.numeric(sample(300))
bg<-ggplot(fake, aes(x=child, y=dp)) + geom_point(aes(color=sunny)) + geom_smooth(method="lm")
eg<-ggplot(fake.e, aes(x=child.e, y=dp.e)) + geom_point(aes(color=sunny.e)) + geom_smooth(method="lm")
sg<-ggplot(fake.s, aes(x=child.s, y=dp.s)) + geom_point(aes(color=sunny.s)) + geom_smooth(method="lm")
grid.arrange(bg,eg,sg, ncol=3, nrow=1)
display(mod.base);display(mod.e);display(mod.s)
mod.base<-lm(dp~sunny, data=fake)
mod.e<-lm(dp.e~sunny.e, data=fake.e)
mod.s<-lm(dp.s~sunny.s, data=fake.s)
display(mod.base);display(mod.e);display(mod.s)
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load Libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(egg)
library(purrr)
library(broom)
library(brms)
# Setting working directory
setwd("~/Documents/git/regionalrisk/analyses/")
bb<-read.csv("output/regrisk.cleaned.csv", header=TRUE)
bb.mat<-subset(bb, select=c(year, species, cc, sp.temp, fs.count))
bb.mat<-bb.mat[!duplicated(bb.mat),]
mat<-bb.mat%>%
group_by(cc, species)%>%
nest
sp_mod<-function(df){
brm(fs.count~sp.temp, data=df)
}
models<-mat%>%
mutate(mod = map(data, sp_mod))
models<-mat%>%
mutate(mod = map(data, sp_mod))
model<-models%>%
mutate(tidy=map(mod, broom::tidy))
mat.tidy<-unnest(model, tidy)
#mat.df<-unnest(models, data)
#mat.df<-inner_join(mat.df, mat.tidy)
mat.df<-mat.tidy%>%
select(cc, species, term, estimate)%>%
spread(term, estimate)
View(mat.df)
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(ylim=c(-0.2, -0.06), xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(ylim=c(-0.2, -0.06), xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(ylim=c(-0.2, -0.06), xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") #+
mat
bb.ele<-subset(bb, select=c(year, species, cc, elev, fs.count))
bb.ele<-bb.ele[!duplicated(bb.ele),]
ele<-bb.ele%>%
group_by(cc, species)%>%
nest
brm(fs.count~elev, data=df, chains=2)
View(ele)
ele_mod<-function(df){
brm(fs.count~elev, data=df, chains=2)
}
ele.models<-ele%>%
mutate(mod = map(data, ele_mod))
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(1, 4)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ele.model<-ele.models%>%
mutate(tidy=map(mod, broom::tidy))
ele.tidy<-unnest(ele.model, tidy)
#mat.df<-unnest(models, data)
#mat.df<-inner_join(mat.df, mat.tidy)
ele.df<-ele.tidy%>%
select(cc, species, term, estimate)%>%
spread(term, estimate)
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(1, 4)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ele
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(xlim=c(1, 4)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ele
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(1, 1.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
bb.nao<-subset(bb, select=c(year, species, cc, m.index, fs.count))
bb.nao<-bb.nao[!duplicated(bb.nao),]
nao<-bb.nao%>%
group_by(cc, species)%>%
nest
nao_mod<-function(df){
brm(fs.count~m.index, data=df, chains=2)
}
nao.models<-nao%>%
mutate(mod = map(data, nao_mod))
nao.model<-nao.models%>%
mutate(tidy=map(mod, broom::tidy))
nao.tidy<-unnest(models, tidy)
nao.tidy<-unnest(nao.model, tidy)
#mat.df<-unnest(models, data)
#mat.df<-inner_join(mat.df, mat.tidy)
nao.df<-nao.tidy%>%
select(cc, species, term, estimate)%>%
spread(term, estimate)
nao<-ggplot(nao.df, aes(x=b_Intercept, y=b_m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(4, 7)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
nao
nao<-ggplot(nao.df, aes(x=b_Intercept, y=b_m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
#coord_cartesian(xlim=c(4, 7)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
nao
nao<-ggplot(nao.df, aes(x=b_Intercept, y=b_m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(2, 6.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
bb.space<-subset(bb, select=c(year, species, cc, space, fs.count))
bb.space<-bb.space[!duplicated(bb.space),]
space<-bb.space%>%
group_by(cc, species)%>%
nest
space_mod<-function(df){
brm(fs.count~space, data=df, chains=2)
}
space.models<-space%>%
mutate(mod = map(data, space_mod))
bb.space$space<-round(bb.space$space, digits=3)
bb.space<-bb.space[!duplicated(bb.space),]
View(bb.space)
bb.space<-subset(bb, select=c(species, cc, space, fs.count))
bb.space$space<-round(bb.space$space, digits=3)
bb.space<-bb.space[!duplicated(bb.space),]
space<-bb.space%>%
group_by(cc, species)%>%
nest
space_mod<-function(df){
brm(fs.count~space, data=df, chains=2)
}
space.models<-space%>%
mutate(mod = map(data, space_mod))
ele<-ggplot(ele.df, aes(x=`(Intercept)`, y=elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position="none") +
coord_cartesian(xlim=c(1, 4)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
nao<-ggplot(nao.df, aes(x=`(Intercept)`, y=m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(4, 7)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
quartz()
ggarrange(mat, ele, nao, ncol=2, nrow=2)
ggarrange(mat, ele, nao, ncol=2, nrow=2)
nao
nao<-ggplot(nao.df, aes(x=`(Intercept)`, y=m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(4, 7)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
nao
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") #+
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(1, 1.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
nao<-ggplot(nao.df, aes(x=b_Intercept, y=b_m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(2, 6.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ggarrange(mat, ele, nao, ncol=2, nrow=2)
quartz()
ggarrange(mat, ele, nao, ncol=2, nrow=2)
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") #+
ggarrange(mat, ele, nao, ncol=2, nrow=2)
ele
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(1, 1.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ele
plot(ele)
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
#coord_cartesian(xlim=c(1, 1.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ele
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
#plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 1.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ggarrange(mat, ele, nao, ncol=2, nrow=2)
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") #+
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,2.5), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 1.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
nao<-ggplot(nao.df, aes(x=b_Intercept, y=b_m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,1.5), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(2, 6.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ggarrange(ele, mat, nao, ncol=2, nrow=2)
mat<-ggplot(mat.df, aes(x=b_Intercept, y=b_sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(1,1,1,1), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") #+
ele<-ggplot(ele.df, aes(x=b_Intercept, y=b_elev)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Elevation \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(1,1,1,1), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 1.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
nao<-ggplot(nao.df, aes(x=b_Intercept, y=b_m.index)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("NAO \n (slope)") + xlab("Number of False Springs \n (intercept)") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(1,1,1,1), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(2, 6.5)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0, show.legend = FALSE, size=2)
ggarrange(ele, mat, nao, ncol=2, nrow=2)
