postt.plot<- ggplot(postt, aes(x=species, y=Tmin)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
#scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
#coord_cartesian(ylim=c(0,250)) +
geom_hline(yintercept=7.78, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 22, label = "After 1984", family="Helvetica", size=3, fontface="bold")
f<-read.csv("output/fs_yearsitespp.csv", header=TRUE)
f$cc<-ifelse(f$year<1984, 0, 1)
f$species<-ifelse(f$species=="BETPEN", "aaBETPEN", f$species)
f$species<-ifelse(f$species=="FRAEXC", "zFRAEXC", f$species)
f<-f[!is.na(f$fs.count),]
pref<-subset(f, f$cc==0)
postf<-subset(f, f$cc==1)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
pref.plot<- ggplot(pref, aes(x=species, y=fs.count)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs") + coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
View(pref.plot)
pref.plot<- ggplot(pref, aes(x=species, y=fs.count)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs") + coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
pref.plot
f$decades<-NA
f$decades<-ifelse(f$year>=1950 & f$year<1960, 1, f$decades)
f$decades<-ifelse(f$year>=1960 & f$year<1970, 2, f$decades)
f$decades<-ifelse(f$year>=1970 & f$year<1980, 3, f$decades)
f$decades<-ifelse(f$year>=1980 & f$year<1990, 4, f$decades)
f$decades<-ifelse(f$year>=1990 & f$year<2000, 5, f$decades)
f$decades<-ifelse(f$year>=2000 & f$year<2010, 6, f$decades)
f$decades<-ifelse(f$year>=2010 & f$year<2020, 7, f$decades)
f$fs.dec<-ave(f$fs.count, f$decade)
f<-read.csv("output/fs_yearsitespp.csv", header=TRUE)
f$cc<-ifelse(f$year<1980, 0, 1)
f$species<-ifelse(f$species=="BETPEN", "aaBETPEN", f$species)
f$species<-ifelse(f$species=="FRAEXC", "zFRAEXC", f$species)
f<-f[!is.na(f$fs.count),]
f$decades<-NA
f$decades<-ifelse(f$year>=1950 & f$year<1960, 1, f$decades)
f$decades<-ifelse(f$year>=1960 & f$year<1970, 2, f$decades)
f$decades<-ifelse(f$year>=1970 & f$year<1980, 3, f$decades)
f$decades<-ifelse(f$year>=1980 & f$year<1990, 4, f$decades)
f$decades<-ifelse(f$year>=1990 & f$year<2000, 5, f$decades)
f$decades<-ifelse(f$year>=2000 & f$year<2010, 6, f$decades)
f$decades<-ifelse(f$year>=2010 & f$year<2020, 7, f$decades)
f$fs.dec<-ave(f$fs.count, f$decade)
pref<-subset(f, f$cc==0)
postf<-subset(f, f$cc==1)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
pref.plot<- ggplot(pref, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs") + coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
postf.plot<- ggplot(postf, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.01, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "After 1984", family="Helvetica", size=3, fontface="bold")
quartz()
ggarrange(pre.plot, post.plot,
pret.plot, postt.plot,
pref.plot, postf.plot, ncol=2, nrow=3)
f<-read.csv("output/fs_yearsitespp.csv", header=TRUE)
f$cc<-ifelse(f$year<1980, 0, 1)
f$species<-ifelse(f$species=="BETPEN", "aaBETPEN", f$species)
f$species<-ifelse(f$species=="FRAEXC", "zFRAEXC", f$species)
f<-f[!is.na(f$fs.count),]
f$decades<-NA
f$decades<-ifelse(f$year>=1950 & f$year<1960, 1, f$decades)
f$decades<-ifelse(f$year>=1960 & f$year<1970, 2, f$decades)
f$decades<-ifelse(f$year>=1970 & f$year<1980, 3, f$decades)
f$decades<-ifelse(f$year>=1980 & f$year<1990, 4, f$decades)
f$decades<-ifelse(f$year>=1990 & f$year<2000, 5, f$decades)
f$decades<-ifelse(f$year>=2000 & f$year<2010, 6, f$decades)
f$decades<-ifelse(f$year>=2010 & f$year<2020, 7, f$decades)
f$fs.dec<-ave(f$fs.count, f$decade, FUN=sum())
pref<-subset(f, f$cc==0)
postf<-subset(f, f$cc==1)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
pref.plot<- ggplot(pref, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs") + coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
postf.plot<- ggplot(postf, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.01, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "After 1984", family="Helvetica", size=3, fontface="bold")
f<-read.csv("output/fs_yearsitespp.csv", header=TRUE)
f$cc<-ifelse(f$year<1980, 0, 1)
f$species<-ifelse(f$species=="BETPEN", "aaBETPEN", f$species)
f$species<-ifelse(f$species=="FRAEXC", "zFRAEXC", f$species)
f<-f[!is.na(f$fs.count),]
f$decades<-NA
f$decades<-ifelse(f$year>=1950 & f$year<1960, 1, f$decades)
f$decades<-ifelse(f$year>=1960 & f$year<1970, 2, f$decades)
f$decades<-ifelse(f$year>=1970 & f$year<1980, 3, f$decades)
f$decades<-ifelse(f$year>=1980 & f$year<1990, 4, f$decades)
f$decades<-ifelse(f$year>=1990 & f$year<2000, 5, f$decades)
f$decades<-ifelse(f$year>=2000 & f$year<2010, 6, f$decades)
f$decades<-ifelse(f$year>=2010 & f$year<2020, 7, f$decades)
f$fs.dec<-ave(f$fs.count, f$decade, FUN=sum)
pref<-subset(f, f$cc==0)
postf<-subset(f, f$cc==1)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
pref.plot<- ggplot(pref, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs") + coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
postf.plot<- ggplot(postf, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.01, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "After 1984", family="Helvetica", size=3, fontface="bold")
ggarrange(pre.plot, post.plot,
pret.plot, postt.plot,
pref.plot, postf.plot, ncol=2, nrow=3)
pref.plot<- ggplot(pref, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs") + #coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
postf.plot<- ggplot(postf, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
#coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.01, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "After 1984", family="Helvetica", size=3, fontface="bold")
ggarrange(pre.plot, post.plot,
pret.plot, postt.plot,
pref.plot, postf.plot, ncol=2, nrow=3)
View(tm)
f<-read.csv("output/fs_yearsitespp.csv", header=TRUE)
f$cc<-ifelse(f$year<1980, 0, 1)
f$species<-ifelse(f$species=="BETPEN", "aaBETPEN", f$species)
f$species<-ifelse(f$species=="FRAEXC", "zFRAEXC", f$species)
f<-f[!is.na(f$fs.count),]
f$decades<-NA
f$decades<-ifelse(f$year>=1950 & f$year<1960, 1, f$decades)
f$decades<-ifelse(f$year>=1960 & f$year<1970, 2, f$decades)
f$decades<-ifelse(f$year>=1970 & f$year<1980, 3, f$decades)
f$decades<-ifelse(f$year>=1980 & f$year<1990, 4, f$decades)
f$decades<-ifelse(f$year>=1990 & f$year<2000, 5, f$decades)
f$decades<-ifelse(f$year>=2000 & f$year<2010, 6, f$decades)
f$decades<-ifelse(f$year>=2010 & f$year<2020, 7, f$decades)
f$fs.dec<-ave(f$fs.count, f$decade, f$lat.long, FUN=sum)
View(f)
f$lat.long<-paste(f$lat, f$long)
f$fs.dec<-ave(f$fs.count, f$decade, f$lat.long, FUN=sum)
View(f)
pref<-subset(f, f$cc==0)
postf<-subset(f, f$cc==1)
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
pref.plot<- ggplot(pref, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs") + #coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
postf.plot<- ggplot(postf, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
#coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.01, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 12.5, label = "After 1984", family="Helvetica", size=3, fontface="bold")
ggarrange(pre.plot, post.plot,
pret.plot, postt.plot,
pref.plot, postf.plot, ncol=2, nrow=3)
pref.plot<- ggplot(pref, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs \nper Decade") + #coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 160, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
postf.plot<- ggplot(postf, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
#coord_cartesian(ylim=c(0,13)) +
geom_hline(yintercept=0.01, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 160, label = "After 1984", family="Helvetica", size=3, fontface="bold")
ggarrange(pre.plot, post.plot,
pret.plot, postt.plot,
pref.plot, postf.plot, ncol=2, nrow=3)
pref.plot<- ggplot(pref, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), legend.position = "none",
plot.margin = unit(c(1.5,0,1.5,1.5), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Number of False Springs \nper Decade") + coord_cartesian(ylim=c(0,165)) +
geom_hline(yintercept=0.04, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 160, label = "Before 1984", family="Helvetica", size=3, fontface="bold")
postf.plot<- ggplot(postf, aes(x=species, y=fs.dec)) + geom_boxplot(aes(col=as.factor(species))) +
scale_colour_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), axis.title.y = element_blank(),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
plot.margin = unit(c(1.5,1.5,1.5,-0.2), "lines"), axis.title.x = element_blank(),
axis.text.x.bottom  = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"ALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
coord_cartesian(ylim=c(0,165)) +
geom_hline(yintercept=0.01, linetype="dotted", col="black") +
annotate("text", x = 5.75, y = 160, label = "After 1984", family="Helvetica", size=3, fontface="bold")
ggarrange(pre.plot, post.plot,
pret.plot, postt.plot,
pref.plot, postf.plot, ncol=2, nrow=3)
mean(pref$fs.dec)
mean(postf$fs.dec)
