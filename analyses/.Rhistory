library("bibtex", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("knitcitations", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("knitr", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
## housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load Libraries
library(dplyr)
library(tidyr)
library(adespatial)
library(ade4)
library(spdep)
# Set Working Directory
setwd("~/Documents/git/regionalrisk/analyses/")
## Get Data
bb<-read.csv("output/fs_matspsite.csv", header=TRUE)
bb$lat.long<-paste(bb$lat, bb$long)
bprep<-bb%>%dplyr::select(fs, lat.long)
bprep$y<-ave(bprep$fs, bprep$lat.long, FUN=sum)
bprep<-dplyr::select(bprep, lat.long, y)
bprep<-bprep[!duplicated(bprep),]
bcoord<-bprep%>%dplyr::select(lat.long)
bcoords<-as.data.frame(bcoord[!duplicated(bcoord),])
bcoords<-separate(data = bcoords, col = 1, into = c("lat", "long"), sep = "\\ ")
bcoords$lat<-as.numeric(bcoords$lat)
bcoords$long<-as.numeric(bcoords$long)
library(gstat)
library(fields)
sub_data<-bb%>%dplyr::select(fs, lat, long, lat.long)
sub_data$fs<-ave(sub_data$fs, sub_data$lat.long, FUN=sum)
sub_data<-dplyr::select(sub_data, -lat.long)
sub_data<-sub_data[!duplicated(sub_data),]
fitTps <- Tps(sub_data[c("lat", "long")], sub_data[,"fs"])
