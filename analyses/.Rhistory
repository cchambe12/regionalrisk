#bb.map<-subset(bb, select=columnstokeep.map)
bb.stan <- subset(bb, select=columnstokeep)
View(bb.stan)
bb.stan<-bb.stan[!duplicated(bb.stan),]
#bb.map<-bb.map[!duplicated(bb.map),]
bb.stan<-na.omit(bb.stan)
#bb.stan<-bb
write.csv(bb.stan, file="~/Documents/git/regionalrisk/analyses/output/bb.brm.nointer.csv", row.names = FALSE)
install.packages(tableplot)
install.packages("tableplot")
library(tableplot)
colnames(bb)
### Try tableplot
tableplot(bb, select = c(sp.temp, elev, space, m.index), sortCol = cc)
### Try tableplot
tableplot(bb, select = c(sp.temp, elev, space, m.index), sortCol = species)
# Load Libraries
library(ggplot2)
### Try tableplot
tableplot(bb)
### Try tableplot
tableplot(bb.stan)
tableplot(bb, select = c(sp.temp, elev, space, m.index), sortCol = c(cc, species))
detach("package:tableplot", unload=TRUE)
remove.packages("tableplot")
install.packages("tabplot")
library(tabplot)
tableplot(bb, select = c(sp.temp, elev, space, m.index), sortCol = c(cc, species))
View(bb.stan)
View(bb)
tableplot(bb, select = c(sp.temp, elev, space, m.index), sortCol = cc)
tableplot(bb, select = c(sp.temp, elev, space, m.index), sortCol = bb$cc)
### Try tableplot
tableplot(bb.stan)
tableplot(bb.stan, select = c(sp.temp, elev, space, m.index), sortCol = cc)
colnames(bb.stan)
### Try tableplot
bb<-na.omit(bb)
### Try tableplot
bb<-bb[!duplicated(bb),]
bb<-na.omit(bb)
tableplot(bb, select = c(sp.temp, elev, space, m.index), sortCol = cc)
colnames(bb)
tableplot(bb.stan, select = c(sp.temp, sm.elev, space, m.index), sortCol = cc)
tableplot(bb.stan, select = c(sp.temp, sm.elev, space, m.index), sortCol = species)
tableplot(bb.stan, select = c(sp.temp, sm.elev, space, m.index))
### Try tableplot
commoncols<-c("sp.temp", "elev", "space", "m.index", "fs.count", "cc", "species")
bb<-subset(bb, select=commoncols)
bb<-bb[!duplicated(bb),]
bb<-na.omit(bb)
pre<-bb[(bb$cc==0),]
post<-bb[(bb$cc==1),]
plot(tp2-tp1)
tp1<-tableplot(pre, plot=FALSE)
tp2<-tableplot(post, plot=FALSE)
plot(tp2-tp1)
tableplot(pre, select=c(sp.temp, sm.elev, space, m.index, fs.count))
tableplot(pre, select=c(sp.temp, elev, space, m.index, fs.count))
tp1<-tableplot(pre, select=c(sp.temp, elev, space, m.index, fs.count))
tp2<-tableplot(post, select=c(sp.temp, elev, space, m.index, fs.count))
plot(tp2-tp1)
pre <- bb[sample(1:nrow(bb[cc==0]), replace=TRUE),]
pre <- bb[sample(1:nrow(bb[bb$cc==0]), replace=TRUE),]
pre <- bb[sample(1:nrow(bb[bb$cc==0],), replace=TRUE),]
pre <- bb[sample(1:nrow(bb(which[bb$cc==0],)), replace=TRUE),]
pre <- bb[sample(1:nrow(bb[which(bb$cc==0),]), replace=TRUE),]
post <- bb[sample(1:nrow(bb[which(bb$cc==1),]), replace=TRUE),]
tp1<-tableplot(pre, select=c(sp.temp, elev, space, m.index, fs.count))
tp2<-tableplot(post, select=c(sp.temp, elev, space, m.index, fs.count))
plot(tp2-tp1)
mat<-bb%>%
select(fs.count, species, sp.temp, cc)%>%
group_by(species)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
library(dplyr)
library(tidyr)
library(egg)
mat<-bb%>%
select(fs.count, species, sp.temp, cc)%>%
group_by(species)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
View(mat)
mat<-bb%>%
select(fs.count, species, sp.temp, cc)%>%
group_by(cc)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
View(mat)
mat<-bb%>%
select(fs.count, species, sp.temp, cc)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
View(mat)
mat<-bb%>%
select(fs.count, species, sp.temp, cc)%>%
group_by(species, cc)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
View(mat)
mat<-bb%>%
select(fs.count, species, sp.temp, cc)%>%
group_by(cc)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
View(mat)
mat<-bb%>%
group_by(species, cc)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
View(mat)
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc), fill=as.factor(species))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(bb, aes(x=sp.temp, y=fs.count)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc), fill=as.factor(species))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
#tableplot(bb.stan)
tableplot(bb, select = c(sp.temp, elev, space, m.index, cc, species), sortCol = cc)
#tableplot(bb.stan)
tableplot(bb, select = c(sp.temp, elev, space, m.index, cc, species, fs.count), sortCol = cc)
#tableplot(bb.stan)
bb$cc<-ifelse(bb$cc==1, "After 1983", "Before 1983")
tableplot(bb, select = c(elev, cc, species, fs.count), sortCol = cc)
colnames(bb)
bb<-read.csv("output/regrisk.cleaned.csv", header=TRUE)
mat<-bb%>%
group_by(lat.long)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc), fill=as.factor(species))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
View(mat)
mat<-bb%>%
group_by(lat.long, cc, species)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
View(mat)
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc), fill=as.factor(species))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
mat<-bb%>%
group_by(lat.long, cc)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc), fill=as.factor(species))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat.df<-bb%>%
group_by(lat.long, cc)%>%
summarise(count=n(), mat=mean(sp.temp), fs=mean(fs.count)) %>%
collect
#bb$fs.mat<-round(bb$sp.temp, digits=0)
#bb$fs.mat<-ave(bb$fs.count, bb$fs.mat)
mat<-ggplot(mat.df, aes(x=mat, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Mean Spring Temperature") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
elev.df<-bb%>%
group_by(lat.long, cc)%>%
summarise(count=n(), elev=mean(elev), fs=mean(fs.count)) %>%
collect
elev<-ggplot(elev.df, aes(x=elev, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Elevation") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 1800), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
elev
nao.df<-bb%>%
group_by(lat.long, cc)%>%
summarise(count=n(), nao=mean(nao), fs=mean(fs)) %>%
collect
nao.df<-bb%>%
group_by(lat.long, cc)%>%
summarise(count=n(), nao=mean(m.index), fs=mean(fs)) %>%
collect
nao.df<-bb%>%
group_by(lat.long, cc)%>%
summarise(count=n(), nao=mean(m.index), fs=mean(fs.count)) %>%
collect
nao<-ggplot(nao.df, aes(x=nao, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("NAO Index") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(-1.5, 0.75), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
nao
space<-ggplot(space.df, aes(x=space, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Space") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-50, 100), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
space.df<-bb%>%
group_by(lat.long, cc)%>%
summarise(count=n(), space=mean(space), fs=mean(fs.count)) %>%
collect
space<-ggplot(space.df, aes(x=space, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Space") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-50, 100), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
quartz()
ggarrange(elev, mat, nao, space, ncol=2, nrow=2)
View(elev.df)
elev.df<-bb%>%
group_by(lat.long, cc, species)%>%
summarise(count=n(), elev=mean(elev), fs=mean(fs.count)) %>%
collect
elev<-ggplot(elev.df, aes(x=elev, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Elevation") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 1800), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0)) + facet_wrap(~species)
elev
colnames(bb)
quartz()
ggarrange(elev, mat, nao, space, ncol=2, nrow=2)
elev<-ggplot(elev.df, aes(x=elev, y=fs)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + xlab("Elevation") + ylab("Average Number \n of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3"), legend.position = "none") +
coord_cartesian(xlim=c(0, 1800), ylim=c(0, 9)) + scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(alpha=0.1, aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
quartz()
ggarrange(elev, mat, nao, space, ncol=2, nrow=2)
#### Let's try Hadley's Methods!
# Maybe subset by each type of model I want to run...?
bb.mat<-subset(bb, select=c(year, species, cc, sp.temp, fs.count))
bb.mat<-bb.mat[!duplicated(bb.mat),]
mat<-bb.mat%>%
group_by(cc, species)%>%
nest
#mat.df<-unnest(models, data)
#mat.df<-inner_join(mat.df, mat.tidy)
mat.df<-bb.mat%>%
select(cc, species, sp.temp, fs.count)
#### Let's try Hadley's Methods!
# Maybe subset by each type of model I want to run...?
bb.mat<-subset(bb, select=c(year, species, cc, sp.temp, fs.count))
bb.mat<-bb.mat[!duplicated(bb.mat),]
mat<-bb.mat%>%
group_by(cc, species)%>%
nest
sp_mod<-function(df){
glm(fs.count~sp.temp, data=df, family=poisson)
}
library(purrr)
library(broom)
models<-mat%>%
mutate(mod = map(data, sp_mod))
models<-models%>%
mutate(tidy=map(mod, broom::tidy))
mat.tidy<-unnest(models, tidy)
#mat.df<-unnest(models, data)
#mat.df<-inner_join(mat.df, mat.tidy)
mat.df<-mat.tidy%>%
select(cc, species, term, estimate)%>%
spread(term, estimate)
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(aes(shape=as.factor(cc))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(linetype=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(aes(shape=as.factor(cc), col=as.factor(species))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(linetype=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) +
scale_colour_manual(values=c("blue", "firebrick3", "orangered1","orange3", "sienna2", "green4", "purple2"),
labels=c("Overall Effects",
"Aesculus hippocastanum" = expression(paste(italic("Aesculus hippocastanum"))),
"Alnus glutinosa" = expression(paste(italic("Alnus glutinosa"))),
"Betula pendula" = expression(paste(italic("Betula pendula"))),
"Fagus sylvatica" = expression(paste(italic("Fagus sylvatica"))),
"Fraxinus excelsior" = expression(paste(italic("Fraxinus excelsior"))),
"Quercus robur" = expression(paste(italic("Quercus robur"))))) +
geom_jitter(aes(shape=as.factor(cc), col=as.factor(species))) +
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") + guides(shape = guide_legend(override.aes = list(alpha=1))) +
scale_y_continuous(expand = c(0, 0))
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(aes(shape=as.factor(cc))) + geom_text(aes(label=species),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_jitter(aes(shape=as.factor(cc))) + geom_text(aes(label=species),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
#coord_cartesian(xlim=c(-14, 15), ylim=c(0, 9)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_point(aes(shape=as.factor(cc))) + geom_text(aes(label=species),hjust=0, vjust=0)
mat
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(xlim=c(-0.2, -0.06), ylim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_point(aes(shape=as.factor(cc))) + geom_text(aes(label=species),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(ylim=c(-0.2, -0.06), xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_point(aes(shape=as.factor(cc))) + geom_text(aes(label=species),hjust=0, vjust=0)
mat
scale_shape_manual(values=c(3, 5), labels=c("Before 1983", "After 1983"), name="") #+
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(ylim=c(-0.2, -0.06), xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
geom_point(aes(shape=as.factor(cc))) + geom_text(aes(label=species),hjust=0, vjust=0)
mat
mat<-ggplot(mat.df, aes(x=`(Intercept)`, y=sp.temp)) + geom_line(aes(col=as.factor(cc)),stat="smooth",method="lm") + ylab("Mean Spring Temperature") + xlab("Number of False Springs") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"), legend.key=element_blank(),
plot.margin = unit(c(2,2,2,2), "lines"),
plot.title=element_text(colour = "firebrick3")) +
coord_cartesian(ylim=c(-0.2, -0.06), xlim=c(0, 2)) +
scale_color_manual(values=c("red4", "blue3"), labels=c("Before 1983", "After 1983"), name="") +
#geom_point(aes(shape=as.factor(cc))) +
geom_text(aes(label=species, col=as.factor(cc)),hjust=0, vjust=0)
mat
