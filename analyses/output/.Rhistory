setwd("~/Documents/git/regionalrisk/analyses/input")
raster1<-brick("//128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("//128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("..//128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("~/128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("./128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
eur.temp <- nc_open("//128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc")
raster1<-brick("//smb:128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("~/smb:128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("~/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
raster1<-brick("//WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
setwd("/Volumes/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data")
raster1<-brick("tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
plot(raster1[[1]])
length(doy)/365
doy<-ncvar_get(eur.temp, "time")
doy<-as.Date(doy, origin="1950-01-01")
day<-substr(doy, 9,10)
eur.temp <- nc_open("//128.103.155.31/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data/tn_0.25deg_reg_v15.0.nc")
eur.temp<-nc_open("tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
eur.temp<-nc_open("tn_0.25deg_reg_v15.0.nc")
length(doy)/365
doy<-ncvar_get(eur.temp, "time")
doy<-as.Date(doy, origin="1950-01-01")
day<-substr(doy, 9,10)
length(doy)/365
year<-as.numeric(substr(doy, 1, 4))
month<-as.numeric(substr(doy, 6, 7))
timevec<-paste(year, month, day, sep="-")
years.vec<-as.character(timevec, format="Y-%m-%d")
dates<-as.Date(years.vec)
names(raster1)<-dates
year<-1950:2016
num.false.spring.year<-list()
for(i in 1950:2016){#i=1952
print(i)
year.i<-i
sequence.years<-which(year==year.i)
#length(sequence.years)
raster.sub<-subset(raster1,sequence.years)
#numnonas<-sum(!is.na(values(raster.sub[[1]])))
rast.array<-array(NA,dim=c(ncell(raster.sub),141))
for(j in 1:141){ ## you need to change
print(j)
rast.array[,j]<-values(raster.sub[[j]])
}
num.false.spring<-apply(rast.array,1,function(x){sum(ifelse(x<2.2,1,0))})
non.nas.ids<-which(!is.na(num.false.spring))
values(empty.raster)<- NA
#plot(raster1[[1]])
values(empty.raster)[non.nas.ids]<- num.false.spring[!is.na(num.false.spring)]
#plot(empty.raster)
num.false.spring.year[[i]]<-empty.raster
}
year<-1950:2016
years.vec
year<-as.numeric(substr(years.vec, 1, 4))
year
num.false.spring.year<-list()
for(i in 1950:2016){#i=1952
print(i)
year.i<-i
sequence.years<-which(year==year.i)
#length(sequence.years)
raster.sub<-subset(raster1,sequence.years)
#numnonas<-sum(!is.na(values(raster.sub[[1]])))
rast.array<-array(NA,dim=c(ncell(raster.sub),141))
for(j in 1:141){ ## you need to change
print(j)
rast.array[,j]<-values(raster.sub[[j]])
}
num.false.spring<-apply(rast.array,1,function(x){sum(ifelse(x<2.2,1,0))})
non.nas.ids<-which(!is.na(num.false.spring))
values(empty.raster)<- NA
#plot(raster1[[1]])
values(empty.raster)[non.nas.ids]<- num.false.spring[!is.na(num.false.spring)]
#plot(empty.raster)
num.false.spring.year[[i]]<-empty.raster
}
empty.raster<-raster1[[1]]
values(empty.raster)<-NA
num.false.spring.year<-list()
for(i in 1950:2016){#i=1952
print(i)
year.i<-i
sequence.years<-which(year==year.i)
#length(sequence.years)
raster.sub<-subset(raster1,sequence.years)
#numnonas<-sum(!is.na(values(raster.sub[[1]])))
rast.array<-array(NA,dim=c(ncell(raster.sub),141))
for(j in 1:141){ ## you need to change
print(j)
rast.array[,j]<-values(raster.sub[[j]])
}
num.false.spring<-apply(rast.array,1,function(x){sum(ifelse(x<2.2,1,0))})
non.nas.ids<-which(!is.na(num.false.spring))
values(empty.raster)<- NA
#plot(raster1[[1]])
values(empty.raster)[non.nas.ids]<- num.false.spring[!is.na(num.false.spring)]
#plot(empty.raster)
num.false.spring.year[[i]]<-empty.raster
}
leaps(year.i)
leaps <- function(x) {
m <- c()
for(i in 1:50) {
year.i <- years[which(((years %% 4 == 0) & (years %% 100 !=0) | (years %% 400 == 0)))]
m <- c(m, year.i)
}
return(m)
}
leap.years<-as.data.frame(leaps(1))
years<-1950:2016
leaps <- function(x) {
m <- c()
for(i in 1:50) {
year.i <- years[which(((years %% 4 == 0) & (years %% 100 !=0) | (years %% 400 == 0)))]
m <- c(m, year.i)
}
return(m)
}
leap.years<-as.data.frame(leaps(1))
leap.years<-leap.years[!duplicated(leaps(1)),]
leap.years
num.false.spring.year<-list()
for(i in 1950:2016){#i=1952
print(i)
year.i<-i
is.leap<-ifelse(year.i%in%leap.years,TRUE,FALSE)
sequence.years<-which(year==year.i)
#length(sequence.years)
raster.sub<-subset(raster1,sequence.years)
#numnonas<-sum(!is.na(values(raster.sub[[1]])))
rast.array<-array(NA,dim=c(ncell(raster.sub),141))
if(is.leap){
for(j in 45:181){ ## you need to change
print(j)
rast.array[,j]<-values(raster.sub[[j]])
}
}
if(!is.leap){
for(j in 45:180){ ## you need to change
print(paste(year.i,j))
rast.array[,j]<-values(raster.sub[[j]])
}
}
num.false.spring<-apply(rast.array,1,function(x){sum(ifelse(x<2.2,1,0))})
non.nas.ids<-which(!is.na(num.false.spring))
values(empty.raster)<- NA
#plot(raster1[[1]])
values(empty.raster)[non.nas.ids]<- num.false.spring[!is.na(num.false.spring)]
#plot(empty.raster)
num.false.spring.year[[i]]<-empty.raster
}
for(i in 1950:2016){#i=1952
print(i)
year.i<-i
is.leap<-ifelse(year.i%in%leap.years,TRUE,FALSE)
sequence.years<-which(year==year.i)
#length(sequence.years)
raster.sub<-subset(raster1,sequence.years)
#numnonas<-sum(!is.na(values(raster.sub[[1]])))
rast.array<-array(NA,dim=c(ncell(raster.sub),181))
if(is.leap){
for(j in 45:181){ ## you need to change
print(j)
rast.array[,j]<-values(raster.sub[[j]])
}
}
if(!is.leap){
for(j in 45:180){ ## you need to change
print(paste(year.i,j))
rast.array[,j]<-values(raster.sub[[j]])
}
}
num.false.spring<-apply(rast.array,1,function(x){sum(ifelse(x<2.2,1,0))})
non.nas.ids<-which(!is.na(num.false.spring))
values(empty.raster)<- NA
#plot(raster1[[1]])
values(empty.raster)[non.nas.ids]<- num.false.spring[!is.na(num.false.spring)]
#plot(empty.raster)
num.false.spring.year[[i]]<-empty.raster
}
final.raster<-stack(unlist(num.false.spring.year))
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(ncdf4)
library(Interpol.T)
library(chillR)
library(raster)
setwd("/Volumes/WeldShare/Wolkovich Lab/Budburst Review - Ospree/Climate Data")
raster1<-brick("tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
rast.array<-as.array(raster1[[45]])
rast.array
rast.back<-raster(rast.array)
rast.back<-brick(rast.array)
plot(rast.back)
timevec<-paste(year, month, day, sep="-")
years.vec<-as.character(timevec, format="Y-%m-%d")
doy<-ncvar_get(eur.temp, "time")
doy<-as.Date(doy, origin="1950-01-01")
day<-substr(doy, 9,10)
year<-as.numeric(substr(doy, 1, 4))
month<-as.numeric(substr(doy, 6, 7))
timevec<-paste(year, month, day, sep="-")
years.vec<-as.character(timevec, format="Y-%m-%d")
year<-as.numeric(substr(years.vec, 1, 4))
raster1<-brick("tn_0.25deg_reg_v15.0.nc", varname="tn", sep="")
eur.temp<-nc_open("tn_0.25deg_reg_v15.0.nc")
doy<-ncvar_get(eur.temp, "time")
doy<-as.Date(doy, origin="1950-01-01")
day<-substr(doy, 9,10)
year<-as.numeric(substr(doy, 1, 4))
month<-as.numeric(substr(doy, 6, 7))
timevec<-paste(year, month, day, sep="-")
years.vec<-as.character(timevec, format="Y-%m-%d")
year<-as.numeric(substr(years.vec, 1, 4))
dates<-as.Date(years.vec)
names(raster1)<-dates
empty.raster<-raster1[[1]]
values(empty.raster)<-NA
years<-1950:2016
leaps <- function(x) {
m <- c()
for(i in 1:50) {
year.i <- years[which(((years %% 4 == 0) & (years %% 100 !=0) | (years %% 400 == 0)))]
m <- c(m, year.i)
}
return(m)
}
leap.years<-as.data.frame(leaps(1))
leap.years<-leap.years[!duplicated(leaps(1)),]
num.false.spring.year<-list()
for(i in 1950:1952){#i=1952
print(i)
year.i<-i
is.leap<-ifelse(year.i%in%leap.years,TRUE,FALSE)
sequence.years<-which(year==year.i)
#length(sequence.years)
raster.sub<-subset(raster1,sequence.years)
#numnonas<-sum(!is.na(values(raster.sub[[1]])))
rast.array<-array(NA,dim=c(ncell(raster.sub),181))
if(is.leap){
for(j in 45:181){ ## you need to change
print(paste(year.i,j))
rast.array[,j]<-values(raster.sub[[j]])
}
}
if(!is.leap){
for(j in 45:180){ ## you need to change
print(paste(year.i,j))
rast.array[,j]<-values(raster.sub[[j]])
}
}
num.false.spring<-apply(rast.array,1,function(x){sum(ifelse(x<=-2.2,1,0))})
#non.nas.ids<-which(!is.na(num.false.spring))
values(empty.raster)<- NA
#plot(raster1[[1]])
#values(empty.raster)[non.nas.ids]<- num.false.spring[!is.na(num.false.spring)]
values(empty.raster)[num.false.spring]<- num.false.spring[!is.na(num.false.spring)]
#plot(empty.raster)
num.false.spring.year[[i]]<-empty.raster
}
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(arm)
library(data.table)
setwd("~/Documents/git/regionalrisk/analyses/output")
bb<-read.csv("bbch_region_aesculus.csv", header=TRUE)
clim<-read.csv("climate_master.csv", header=TRUE)
clim$date<-as.Date(paste(clim$year, clim$month, clim$day, sep="-"))
bb<-bb%>%dplyr::rename("lat" = LAT)%>%dplyr::rename("long"=LON)
x<-paste(bb$YEAR, bb$DAY)
bb$date<-as.Date(strptime(x, format="%Y %j"))
bb$year<-as.numeric(substr(bb$date, 0,4))
bb$month<-as.numeric(substr(bb$date, 6, 7))
bb$day<-as.numeric(substr(bb$date, 9,10))
bb<-bb%>%dplyr::select(-National_ID, -YEAR)
bb$lat<-round(bb$lat, digits=2)
bb$long<-round(bb$long, digits=2)
clim$lat<-round(clim$lat, digits=2)
clim$long<-round(clim$long, digits=2)
d<-full_join(clim, bb)
d<-filter(d, year>=1950)
d<-filter(d, year<=1980)
d<-d[!(is.na(d$Tmin) & is.na(d$PEP_ID)),]
d$grow<-ifelse(is.na(d$BBCH), NA, TRUE)
d$count <- ave(
d$grow, d$PEP_ID, d$year,
FUN=function(x) cumsum(c(1, head(x, -1)))
)
d$frz<- ifelse((d$Tmin<=-2.2), 1, 0)
plz<- d#%>% filter(year==1997)
plz<-plz[!(is.na(plz$count) & is.na(plz$Tmin)),]
plz<- plz[ave(plz$year, plz$PEP_ID, FUN = length) > 1, ]
plz$count<-ifelse(plz$count==1, "start", plz$count)
View(plz)
plz$pepyear<-paste(plz$PEP_ID, plz$year, sep=",")
plz$pepBB<-paste(plz$pepyear, plz$BBCH, sep=",")
test<-plz
tt<-test%>%
filter(count==2) %>%
group_by(PEP_ID, year) %>%
filter(date==max(date))
tt<-within(tt, count[tt$count==2]<-"end")
dat <- merge(plz, tt, by = "pepBB", all.x = TRUE)
dat<-dat[!(dat$count.x=="start" & dat$count.y=="end"),]
transform(dat, color = ifelse(plz$count!="end",
plz$count, tt$count))[-(2:3)]
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(arm)
library(data.table)
library(lme4)
setwd("~/Documents/git/regionalrisk/analyses/output")
bb<-read.csv("bbch_region_aesculus.csv", header=TRUE)
clim<-read.csv("climate_master.csv", header=TRUE)
clim$date<-as.Date(paste(clim$year, clim$month, clim$day, sep="-"))
bb<-bb%>%dplyr::rename("lat" = LAT)%>%dplyr::rename("long"=LON)
x<-paste(bb$YEAR, bb$DAY)
bb$date<-as.Date(strptime(x, format="%Y %j"))
bb$year<-as.numeric(substr(bb$date, 0,4))
bb$month<-as.numeric(substr(bb$date, 6, 7))
bb$day<-as.numeric(substr(bb$date, 9,10))
bb<-bb%>%dplyr::select(-National_ID, -YEAR)
bb$lat<-round(bb$lat, digits=2)
bb$long<-round(bb$long, digits=2)
clim$lat<-round(clim$lat, digits=2)
clim$long<-round(clim$long, digits=2)
d<-full_join(clim, bb)
d<-filter(d, year>=1950)
d<-d[!duplicated(d),]
#how_many<-d[which(is.na(d$Tmin)),]
d<-d[!(is.na(d$Tmin) & is.na(d$PEP_ID)),]
d$grow<-ifelse(is.na(d$BBCH), NA, TRUE)
d<-arrange(d, date)
d$count <- ave(
d$grow, d$PEP_ID, d$year,
FUN=function(x) cumsum(c(1, head(x, -1)))
)
d$frz<- ifelse((d$Tmin<=-2.2), 1, 0)
plz<- d#%>% filter(year==1997)
plz<-plz[!(is.na(plz$count) & is.na(plz$Tmin)),]
#plz<- plz[ave(plz$year, plz$PEP_ID, FUN = length) > 1, ]
plz$count<-ifelse(plz$count==1, "start", plz$count)
############# WORK ON LAST OBSERVATION! ######################
plz$pepyear<-paste(plz$PEP_ID, plz$year, sep=",")
plz$pepBB<-paste(plz$pepyear, plz$BBCH, sep=",")
test<-plz
#test<- within(test, count[test$count==2]<-2)
tt<-test%>%
filter(count!="start") %>%
group_by(pepBB) %>%
filter(date==max(date))
tt$count<-as.numeric(as.character(tt$count))
tt<-tt[!duplicated(tt), ]
tt$count<-ifelse(tt$count=="start", "start", 2)
tt<-within(tt, count[tt$count==2]<-"end")
dat <- merge(plz, tt, by = "pepBB", all.x = TRUE)
dat$count.x[which(dat$count.x==2 & dat$count.y=="end")]<-"end"
dat$count.x[which(dat$count.x=="start" & dat$count.y=="end")]<-"start"
dat.clean<-dat%>%
dplyr::select(pepBB, year.x, Tmin.x, lat.x, long.x, date.x, PEP_ID.x, BBCH.x, DAY.x, species.x, count.x, frz.x, pepyear.x)%>%
rename(year=year.x)%>%
rename(Tmin=Tmin.x)%>%
rename(lat=lat.x)%>%
rename(long=long.x)%>%
rename(date=date.x)%>%
rename(PEP_ID=PEP_ID.x)%>%
rename(BBCH=BBCH.x)%>%
rename(DAY=DAY.x)%>%
rename(species=species.x)%>%
rename(count=count.x)%>%
rename(frz=frz.x)%>%
rename(pepyear=pepyear.x)
plz<-dat.clean
plz$start<-ifelse(plz$count=="start", plz$date, NA)
class(plz$start)<-"Date"
plz$end<-ifelse(plz$count=="end", plz$date, NA)
class(plz$end)<-"Date"
plz<-filter(plz, year<=1980)
plzers<-plz%>%dplyr::select(year, PEP_ID, start, end, lat, long, pepyear, species)
plzers<-setDT(plzers)[, lapply(.SD, na.omit), by = pepyear]
plzers<-plzers[!(is.na(plzers$PEP_ID))]
plzers$end<-ifelse(is.na(plzers$end), as.Date(plzers$start), as.Date(plzers$end))
class(plzers$end)<-"Date"
please<-plzers %>%
arrange(PEP_ID)%>%
rowwise()%>%
do(data.frame(PEP_ID=.$PEP_ID, year=.$year, pepyear=.$pepyear, lat= .$lat, long=.$long, date = seq.Date(.$start, .$end, by="days")))
freeze<-left_join(please,clim)
freeze<-freeze[!(is.na(freeze$Tmin)),]
freeze$frz<-ifelse(freeze$Tmin<=-2.2, 1, 0)
freeze$count <- ave(
freeze$frz, freeze$PEP_ID, freeze$year,
FUN=function(x) cumsum(c(0, head(x, -1)))
)
peppies<-as.data.frame(table(freeze$pepyear))
peppies<-peppies%>%
rename(pepyear=Var1)%>%
rename(growth=Freq)
freeze<-full_join(freeze, peppies)
dxx<-freeze%>%group_by(PEP_ID, year, lat, long, growth)%>%summarise(frz=max(count))
dxx$fs<-ifelse(dxx$frz>=1, 1, 0)
total<-tally(group_by(dxx,PEP_ID))
total<-rename(total, total=n)
dxx<-full_join(dxx, total)
fs<-dxx%>%dplyr::select(-total)
fs$fs<-ifelse(dxx$fs>=1, 1, NA)
fs<-na.omit(fs)
fs<-tally(group_by(fs,PEP_ID))
fs<-rename(fs, events=n)
dxx<-full_join(dxx, fs)
dxx$events<-ifelse(is.na(dxx$events), 0, dxx$events)
dxx$freq<-dxx$events/dxx$total
model1<-lm(freq~lat*long, data=dxx)
display(model1)
mod<-lm(events~ growth + lat*long, data=dxx)
display(mod)
View(dxx)
write.csv(dxx, "~/Documents/git/regionalrisk/analyses/output/aesculus_events_preCC.csv", row.names=FALSE)
rm(list=ls()) # remove everything currently held in the R memory
options(stringsAsFactors=FALSE)
graphics.off()
# Load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(arm)
library(data.table)
library(lme4)
setwd("~/Documents/git/regionalrisk/analyses/output")
bb<-read.csv("bbch_region_aesculus.csv", header=TRUE)
clim<-read.csv("climate_master.csv", header=TRUE)
clim$date<-as.Date(paste(clim$year, clim$month, clim$day, sep="-"))
bb<-bb%>%dplyr::rename("lat" = LAT)%>%dplyr::rename("long"=LON)
x<-paste(bb$YEAR, bb$DAY)
bb$date<-as.Date(strptime(x, format="%Y %j"))
bb$year<-as.numeric(substr(bb$date, 0,4))
bb$month<-as.numeric(substr(bb$date, 6, 7))
bb$day<-as.numeric(substr(bb$date, 9,10))
bb<-bb%>%dplyr::select(-National_ID, -YEAR)
bb$lat<-round(bb$lat, digits=2)
bb$long<-round(bb$long, digits=2)
clim$lat<-round(clim$lat, digits=2)
clim$long<-round(clim$long, digits=2)
d<-full_join(clim, bb)
d<-filter(d, year>=1950)
d<-d[!duplicated(d),]
#how_many<-d[which(is.na(d$Tmin)),]
d<-d[!(is.na(d$Tmin) & is.na(d$PEP_ID)),]
d$grow<-ifelse(is.na(d$BBCH), NA, TRUE)
d<-arrange(d, date)
d$count <- ave(
d$grow, d$PEP_ID, d$year,
FUN=function(x) cumsum(c(1, head(x, -1)))
)
d$frz<- ifelse((d$Tmin<=-2.2), 1, 0)
plz<- d#%>% filter(year==1997)
plz<-plz[!(is.na(plz$count) & is.na(plz$Tmin)),]
#plz<- plz[ave(plz$year, plz$PEP_ID, FUN = length) > 1, ]
plz$count<-ifelse(plz$count==1, "start", plz$count)
############# WORK ON LAST OBSERVATION! ######################
plz$pepyear<-paste(plz$PEP_ID, plz$year, sep=",")
plz$pepBB<-paste(plz$pepyear, plz$BBCH, sep=",")
test<-plz
#test<- within(test, count[test$count==2]<-2)
tt<-test%>%
filter(count!="start") %>%
group_by(pepBB) %>%
filter(date==max(date))
tt$count<-as.numeric(as.character(tt$count))
tt<-tt[!duplicated(tt), ]
tt$count<-ifelse(tt$count=="start", "start", 2)
tt<-within(tt, count[tt$count==2]<-"end")
dat <- merge(plz, tt, by = "pepBB", all.x = TRUE)
dat$count.x[which(dat$count.x==2 & dat$count.y=="end")]<-"end"
dat$count.x[which(dat$count.x=="start" & dat$count.y=="end")]<-"start"
dat.clean<-dat%>%
dplyr::select(pepBB, year.x, Tmin.x, lat.x, long.x, date.x, PEP_ID.x, BBCH.x, DAY.x, species.x, count.x, frz.x, pepyear.x)%>%
rename(year=year.x)%>%
rename(Tmin=Tmin.x)%>%
rename(lat=lat.x)%>%
rename(long=long.x)%>%
rename(date=date.x)%>%
rename(PEP_ID=PEP_ID.x)%>%
rename(BBCH=BBCH.x)%>%
rename(DAY=DAY.x)%>%
rename(species=species.x)%>%
rename(count=count.x)%>%
rename(frz=frz.x)%>%
rename(pepyear=pepyear.x)
