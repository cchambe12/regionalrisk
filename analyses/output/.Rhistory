geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11))
regrisk
cols <- c("blue", "#CAB1C4", "gold2", "#7FC97F", "#87A6A6", "#BF5B17", "#CB1788")
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur"))),
"0"="Overall Effects"))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11))
regrisk
brms$species<-c(1,1,1,1,1,1, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 1,1,1,1,1)
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(3, 1, 1, 1, 1, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
cols <- c("#CAB1C4", "gold2", "#7FC97F", "#87A6A6", "#BF5B17", "#CB1788")
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(3, 1, 1, 1, 1, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(3, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none",
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.8, 0.15),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.8, 0.15),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.9, 0.25),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.86, 0.19),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.86, 0.2),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.86, 0.195),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/dvr_full.Rdata")
brms<-as.data.frame(tidy(dvr.full,robust = TRUE, prob=0.9))
brms<-brms[2:47,]
brms$term<-gsub(".*b_","",brms$term)
#brms$term<-gsub(".*r_species","",brms$term)
brms<-brms[!(brms$term=="sd_species__nao.z" | brms$term=="sd_species__mat.z" | brms$term=="sd_species__elev.z"
| brms$term=="sd_species__dist.z" | brms$term=="sd_species__space.z" | brms$term=="sd_species__cc.z" | brms$term=="sigma"
| brms$term=="speciesALNGLU" | brms$term=="speciesBETPEN" | brms$term=="speciesFAGSYL"
| brms$term=="speciesFRAEXC" | brms$term=="speciesQUEROB"),]
brms$species<-c(1,1,1,1,1,1, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 1,1,1,1,1)
brms$Jvar<-NA
brms$Jvar<-ifelse(brms$term=="nao.z", 11, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,nao.z]", 8.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesALNGLU", 10.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesBETPEN", 10.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesFAGSYL", 10.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesFRAEXC", 10.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesQUEROB", 10.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z", 10, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,mat.z]", 7.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesALNGLU", 9.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesBETPEN", 9.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesFAGSYL", 9.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesFRAEXC", 9.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesQUEROB", 9.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z", 9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,elev.z]", 6.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesALNGLU", 8.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesBETPEN", 8.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesFAGSYL", 8.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesFRAEXC", 8.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesQUEROB", 8.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z", 8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,dist.z]", 6.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesALNGLU", 7.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesBETPEN", 7.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesFAGSYL", 7.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesFRAEXC", 7.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesQUEROB", 7.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z", 7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,space]", 5.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesALNGLU", 6.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesBETPEN", 6.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesFAGSYL", 6.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesFRAEXC", 6.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesQUEROB", 6.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z", 6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,cc]", 4.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesALNGLU", 5.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesBETPEN", 5.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesFAGSYL", 5.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesFRAEXC", 5.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesQUEROB", 5.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:cc.z", 5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:cc.z", 4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:cc.z", 3, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:cc.z", 2, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:cc.z", 1, brms$Jvar)
brms$species<-as.character(brms$species)
bb<-brms[(brms$species==0),]
cols <- c("#CAB1C4", "gold2", "#7FC97F", "#87A6A6", "#BF5B17", "#CB1788")
estimates<-c("NAO Index", "Mean Spring Temperature", "Elevation", "Distance from Coast", "Space Parameter", "Climate Change",
"NAO Index x \nClimate Change", "Mean Spring Temperature \nx Climate Change", "Elevation x \nClimate Change",
"Distance from Coast \nx Climate Change", "Space Parameter \nx Climate Change")
estimates<-rev(estimates)
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.86, 0.195),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
quartz()
regrisk
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/five_full.Rdata")
brms<-as.data.frame(tidy(five.full,robust = TRUE, prob=0.9))
#brms0<-as.data.frame(tidy(bernsfinal,robust = TRUE))
brms<-brms[2:47,]
brms$term<-gsub(".*b_","",brms$term)
#brms$term<-gsub(".*r_species","",brms$term)
brms<-brms[!(brms$term=="sd_species__nao.z" | brms$term=="sd_species__mat.z" | brms$term=="sd_species__elev.z"
| brms$term=="sd_species__dist.z" | brms$term=="sd_species__space.z" | brms$term=="sd_species__cc.z" | brms$term=="sigma"
| brms$term=="speciesALNGLU" | brms$term=="speciesBETPEN" | brms$term=="speciesFAGSYL"
| brms$term=="speciesFRAEXC" | brms$term=="speciesQUEROB"),]
brms$species<-c(1,1,1,1,1,1, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 1,1,1,1,1)
brms$Jvar<-NA
brms$Jvar<-ifelse(brms$term=="nao.z", 11, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,nao.z]", 8.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesALNGLU", 10.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesBETPEN", 10.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesFAGSYL", 10.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesFRAEXC", 10.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:speciesQUEROB", 10.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z", 10, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,mat.z]", 7.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesALNGLU", 9.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesBETPEN", 9.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesFAGSYL", 9.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesFRAEXC", 9.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:speciesQUEROB", 9.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z", 9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,elev.z]", 6.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesALNGLU", 8.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesBETPEN", 8.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesFAGSYL", 8.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesFRAEXC", 8.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:speciesQUEROB", 8.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z", 8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,dist.z]", 6.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesALNGLU", 7.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesBETPEN", 7.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesFAGSYL", 7.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesFRAEXC", 7.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:speciesQUEROB", 7.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z", 7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,space]", 5.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesALNGLU", 6.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesBETPEN", 6.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesFAGSYL", 6.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesFRAEXC", 6.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:speciesQUEROB", 6.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z", 6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,cc]", 4.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesALNGLU", 5.9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesBETPEN", 5.8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesFAGSYL", 5.7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesFRAEXC", 5.6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z:speciesQUEROB", 5.5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:cc.z", 5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:cc.z", 4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:cc.z", 3, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:cc.z", 2, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:cc.z", 1, brms$Jvar)
brms$species<-as.character(brms$species)
bb<-brms[(brms$species==0),]
cols <- c("#CAB1C4", "gold2", "#7FC97F", "#87A6A6", "#BF5B17", "#CB1788")
estimates<-c("NAO Index", "Mean Spring Temperature", "Elevation", "Distance from Coast", "Space Parameter", "Climate Change",
"NAO Index x \nClimate Change", "Mean Spring Temperature \nx Climate Change", "Elevation x \nClimate Change",
"Distance from Coast \nx Climate Change", "Space Parameter \nx Climate Change")
estimates<-rev(estimates)
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.86, 0.195),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1, 1), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
quartz()
regrisk
regrisk<-ggplot(brms, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
scale_color_manual(name="Species", values=cols,
labels=c("1"=bquote(paste(italic("Aesculus hippocastanum"))),
"2"=bquote(paste(italic("Alnus glutinosa"))),
"3"=bquote(paste(italic("Betula pendula"))),
"4"=bquote(paste(italic("Fagus sylvatica"))),
"5"=bquote(paste(italic("Fraxinus excelsior"))),
"6"=bquote(paste(italic("Quercus robur")))))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
guides(size=FALSE) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = c(0.86, 0.195),
legend.text.align = 0) +  #+ ggtitle("Original Parameters") +
coord_cartesian(xlim=c(-1.5, 1.5), ylim=c(1,11)) +
scale_size_manual(values=c(2, 1, 1, 1, 1, 1), name="Species",
labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
"2"=expression(paste(italic("Alnus glutinosa"))),
"3"=expression(paste(italic("Betula pendula"))),
"4"=expression(paste(italic("Fagus sylvatica"))),
"5"=expression(paste(italic("Fraxinus excelsior"))),
"6"=expression(paste(italic("Quercus robur")))))
regrisk
