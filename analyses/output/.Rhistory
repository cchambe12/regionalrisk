"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
spacesp$group<-ifelse(spacesp$group=="BETPEN", "aaBETPEN", spacesp$group)
spacesp$group<-ifelse(spacesp$group=="FRAEXC", "zFRAEXC", spacesp$group)
spacesp.p<-ggplot(spacesp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of False Spring") +
ggtitle("D.") + scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.1)) +
theme_classic() + theme(legend.position = "none") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
#ccsp<- ggpredict(orig.full, terms = c("cc.z", "species"), ci.lvl = 0.5)
#write.csv(ccsp, file="~/Documents/git/regionalrisk/analyses/output/ccsp_predicted.csv", row.names = FALSE)
#write.csv(ccsp, file="~/Documents/git/regionalrisk/analyses/output/ccsp_predicted_50.csv", row.names = FALSE)
#ccsp<-read.csv("~/Documents/git/regionalrisk/analyses/output/ccsp_predicted_50.csv", header=TRUE)
ccsp$group<-ifelse(ccsp$group=="BETPEN", "aaBETPEN", ccsp$group)
ccsp$group<-ifelse(ccsp$group=="FRAEXC", "zFRAEXC", ccsp$group)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.1))  +
theme_classic() + theme(legend.position = "none") +
#theme(legend.text.align = 0, legend.key = element_rect(fill="white")) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.1))  +
theme_classic() + theme(legend.position = "none") +
theme(legend.text.align = 0, legend.key = element_rect(fill="white")) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.1))  +
theme_classic() + #theme(legend.position = "none") +
theme(legend.text.align = 0, legend.key = element_rect(fill="white")) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.1))  +
theme_classic() + theme(legend.position = "none") +
#theme(legend.text.align = 0, legend.key = element_rect(fill="white")) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
quartz()
g1<-grid.arrange(matsp.p, elevsp.p, mylegend, ncol=3, widths=c(1.5, 1.5, 1))
g2<-grid.arrange(naosp.p, spacesp.p, ccsp.p, ncol=3, widths=c(1,1,1))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
spacesp.p<-ggplot(spacesp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of False Spring") +
ggtitle("D.") + scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) +
theme_classic() + theme(legend.position = "none") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1))  +
theme_classic() + theme(legend.position = "none") +
#theme(legend.text.align = 0, legend.key = element_rect(fill="white")) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
View(elevsp)
#naosp<- ggpredict(orig.full, terms = c("nao.z", "species"), ci.lvl=0.5)
#write.csv(naosp, file="~/Documents/git/regionalrisk/analyses/output/naosp_predicted.csv", row.names = FALSE)
#write.csv(naosp, file="~/Documents/git/regionalrisk/analyses/output/naosp_predicted_50.csv", row.names = FALSE)
naosp0<-read.csv("~/Documents/git/regionalrisk/analyses/output/naosp_predicted_50.csv", header=TRUE)
View(naosp0)
View(naosp)
naosp0$group<-ifelse(naosp0$group=="BETPEN", "aaBETPEN", naosp0$group)
naosp0$group<-ifelse(naosp0$group=="FRAEXC", "zFRAEXC", naosp0$group)
naosp.p<-ggplot(naosp0, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("NAO") +
ylab("Probability of False Spring") + ggtitle("C.") + theme_classic() + theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1))+
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
#elevsp<- ggpredict(orig.full, terms = c("elev.z", "species"), ci.lvl=0.5)
#write.csv(elevsp, file="~/Documents/git/regionalrisk/analyses/output/elevsp_predicted.csv", row.names = FALSE)
#write.csv(elevsp, file="~/Documents/git/regionalrisk/analyses/output/elevsp_predicted_50.csv", row.names = FALSE)
elevsp<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevsp_predicted_50.csv", header=TRUE)
elevsp$group<-ifelse(elevsp$group=="BETPEN", "aaBETPEN", elevsp$group)
elevsp$group<-ifelse(elevsp$group=="FRAEXC", "zFRAEXC", elevsp$group)
elevsp.p<-ggplot(elevsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Probability of False Spring") + ggtitle("B.") + theme_classic() + theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
#matsp<- ggpredict(orig.full, terms = c("mat.z", "species"), ci.lvl = 0.5)
#write.csv(matsp, file="~/Documents/git/regionalrisk/analyses/output/matsp_predicted.csv", row.names = FALSE)
#write.csv(matsp, file="~/Documents/git/regionalrisk/analyses/output/matsp_predicted_50.csv", row.names = FALSE)
matsp<-read.csv("~/Documents/git/regionalrisk/analyses/output/matsp_predicted_50.csv", header=TRUE)
matsp$group<-ifelse(matsp$group=="BETPEN", "aaBETPEN", matsp$group)
matsp$group<-ifelse(matsp$group=="FRAEXC", "zFRAEXC", matsp$group)
matsp.p<-ggplot(matsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Mean Spring Temperature") +
ylab("Probability of False Spring") + ggtitle("A.") + theme_classic()+ theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
#spacesp<- ggpredict(orig.full, terms = c("space.z", "species"), ci.lvl = 0.5)
#write.csv(spacesp, file="~/Documents/git/regionalrisk/analyses/output/spacesp_predicted.csv", row.names = FALSE)
#write.csv(spacesp, file="~/Documents/git/regionalrisk/analyses/output/spacesp_predicted_50.csv", row.names = FALSE)
spacesp<-read.csv("~/Documents/git/regionalrisk/analyses/output/spacesp_predicted_50.csv", header=TRUE)
spacesp$group<-ifelse(spacesp$group=="BETPEN", "aaBETPEN", spacesp$group)
spacesp$group<-ifelse(spacesp$group=="FRAEXC", "zFRAEXC", spacesp$group)
spacesp.p<-ggplot(spacesp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of False Spring") +
ggtitle("D.") + scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) +
theme_classic() + theme(legend.position = "none") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
#ccsp<- ggpredict(orig.full, terms = c("cc.z", "species"), ci.lvl = 0.5)
#write.csv(ccsp, file="~/Documents/git/regionalrisk/analyses/output/ccsp_predicted.csv", row.names = FALSE)
#write.csv(ccsp, file="~/Documents/git/regionalrisk/analyses/output/ccsp_predicted_50.csv", row.names = FALSE)
ccsp<-read.csv("~/Documents/git/regionalrisk/analyses/output/ccsp_predicted_50.csv", header=TRUE)
ccsp$group<-ifelse(ccsp$group=="BETPEN", "aaBETPEN", ccsp$group)
ccsp$group<-ifelse(ccsp$group=="FRAEXC", "zFRAEXC", ccsp$group)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1))  +
theme_classic() + #theme(legend.position = "none") +
theme(legend.text.align = 0, legend.key = element_rect(fill="white")) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(ccsp.p)
ccsp.p<-ggplot(ccsp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Climate Change") + ylab("Probability of False Spring") + ggtitle("E.") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1))  +
theme_classic() + theme(legend.position = "none") +
#theme(legend.text.align = 0, legend.key = element_rect(fill="white")) +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g1<-grid.arrange(matsp.p, elevsp.p, mylegend, ncol=3, widths=c(1.5, 1.5, 1))
g2<-grid.arrange(naosp.p, spacesp.p, ccsp.p, ncol=3, widths=c(1,1,1))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
spacesp<- ggpredict(orig.full, terms = c("dist.z", "species"), ci.lvl = 0.5)
#write.csv(spacesp, file="~/Documents/git/regionalrisk/analyses/output/spacesp_predicted.csv", row.names = FALSE)
write.csv(spacesp, file="~/Documents/git/regionalrisk/analyses/output/spacesp_predicted_50.csv", row.names = FALSE)
spacesp<-read.csv("~/Documents/git/regionalrisk/analyses/output/spacesp_predicted_50.csv", header=TRUE)
spacesp$group<-ifelse(spacesp$group=="BETPEN", "aaBETPEN", spacesp$group)
spacesp$group<-ifelse(spacesp$group=="FRAEXC", "zFRAEXC", spacesp$group)
spacesp.p<-ggplot(spacesp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of False Spring") +
ggtitle("D.") + scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) +
theme_classic() + theme(legend.position = "none") +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
g2<-grid.arrange(naosp.p, spacesp.p, ccsp.p, ncol=3, widths=c(1,1,1))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
colz <- colorRampPalette(brewer.pal(9,"Set1"))(2)
colz<-rev(colz)
#nao<-ggpredict(orig.full, terms=c("nao.z", "cc.z"), ci.lvl = 0.5)
#write.csv(nao, file="naopredict.csv", row.names=FALSE)
#write.csv(nao, file="naopredict_50.csv", row.names=FALSE)
nao<-read.csv("~/Documents/git/regionalrisk/analyses/output/naopredict_50.csv", header=TRUE)
nao$group<-as.character(nao$group)
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Probability of \nFalse Spring") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.2)) + ggtitle("C.") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#elev<-ggpredict(orig.full, terms=c("elev.z", "cc.z"), ci.lvl=0.5)
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#write.csv(elev, file="elevpredict_50.csv", row.names=FALSE)
elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict_50.csv", header=TRUE)
elev$group<-as.character(elev$group)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Probability of False Spring") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + ggtitle("B.") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#mat<-ggpredict(orig.full, terms=c("mat.z", "cc.z"), ci.lvl=0.5)
#write.csv(mat, file="~/Documents/git/regionalrisk/analyses/output/matpredict.csv", row.names=FALSE)
#write.csv(mat, file="~/Documents/git/regionalrisk/analyses/output/matpredict_50.csv", row.names=FALSE)
mat<-read.csv("~/Documents/git/regionalrisk/analyses/output/matpredict_50.csv", header=TRUE)
mat$group<-as.character(mat$group)
mat.p<- ggplot(mat, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Mean Spring Temperature") +
ylab("Probability of False Spring") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + ggtitle("A.") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#dist<-ggpredict(orig.full, terms=c("dist.z", "cc.z"), ci.lvl=0.5)
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict_50.csv", row.names=FALSE)
dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict_50.csv", header=TRUE)
dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of \nFalse Spring") +
ggtitle("D.") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.2)) + theme(legend.position = "none") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of \nFalse Spring") +
ggtitle("D.") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.2)) + #theme(legend.position = "none") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(dist.p)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of \nFalse Spring") +
ggtitle("D.") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.2)) + theme(legend.position = "none") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
quartz()
g1<-ggarrange(mat.p, elev.p, ncol=2, widths=c(1.5,1.5))
g2<-grid.arrange(nao.p, dist.p, mylegend, ncol=3, widths=c(1, 1, 0.5))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of \nFalse Spring") +
ggtitle("D.") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + theme(legend.position = "none") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Probability of \nFalse Spring") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + ggtitle("C.") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
View(nao)
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Probability of \nFalse Spring") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + ggtitle("C.") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016"))
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Probability of False Spring") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + ggtitle("B.") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016"))
mat.p<- ggplot(mat, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Mean Spring Temperature") +
ylab("Probability of False Spring") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + ggtitle("A.") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016"))
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of \nFalse Spring") +
ggtitle("D.") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + theme(legend.position = "none") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016"))
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of \nFalse Spring") +
ggtitle("D.") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + #theme(legend.position = "none") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016"))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(dist.p)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Probability of \nFalse Spring") +
ggtitle("D.") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,1)) + theme(legend.position = "none") +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459191120180519"="1950-1983",
"0.544434894155798"="1984-2016"))
g1<-ggarrange(mat.p, elev.p, ncol=2, widths=c(1.5,1.5))
g2<-grid.arrange(nao.p, dist.p, mylegend, ncol=3, widths=c(1, 1, 0.5))
grid.arrange(g1, g2, nrow=2, heights=c(1.5, 1))
