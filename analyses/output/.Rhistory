labels=c(-0.459208492649012="1950-1983",
0.544414297170614="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c(-0.459208492649012="1950-1983",
0.544414297170614="1984-2016"))
View(nao)
View(elev)
View(mat)
#write.csv(nao, file="naopredict.csv", row.names=FALSE)
#nao<-read.csv("~/Documents/git/regionalrisk/analyses/output/naopredict.csv", header=TRUE)
#nao$predicted<-as.integer(nao$predicted)
#nao$x<-as.integer(nao$x)
#nao$group<-as.integer(nao$group)
x<-as.vector(elev$group)
#write.csv(nao, file="naopredict.csv", row.names=FALSE)
#nao<-read.csv("~/Documents/git/regionalrisk/analyses/output/naopredict.csv", header=TRUE)
#nao$predicted<-as.integer(nao$predicted)
#nao$x<-as.integer(nao$x)
#nao$group<-as.integer(nao$group)
x<-as.vector(mat$group)
x<-x[(-15:18), ]
x<-x[-(15:18),]
x<-x[1:14,]
x<-x[1:14]
nao$group<-x
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c(-0.459208492649012="1950-1983",
0.544414297170614="1984-2016"))
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c(-0.459208492649012="1950-1983",
0.544414297170614="1984-2016"))
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
nao.p
elev.p
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
#elev$predicted<-as.integer(elev$predicted)
elev$group<-as.integer(elev$group)
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
#elev$predicted<-as.integer(elev$predicted)
#elev$group<-as.integer(elev$group)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
elev.p
class(elev$x)
class(elev$predicted)
class(elev$group)
elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
elev$predicted<-as.integer(elev$predicted)
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
#elev$predicted<-as.integer(elev$predicted)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=as.factor(group))) + geom_line(aes(col=as.factor(group))) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
elev.p
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
#elev$predicted<-as.integer(elev$predicted)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
elev.p
class(mat$group)
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
#elev$predicted<-as.integer(elev$predicted)
elev$group<-as.character(elev$group)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
elev.p
elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
elev.p
elev$group<-as.character(elev$group)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
elev.p
nao<-read.csv("~/Documents/git/regionalrisk/analyses/output/naopredict.csv", header=TRUE)
nao$group<-as.character(nao$group)
#write.csv(nao, file="naopredict.csv", row.names=FALSE)
#nao<-read.csv("~/Documents/git/regionalrisk/analyses/output/naopredict.csv", header=TRUE)
#nao$group<-as.character(nao$group)
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
dist$group<-as.character(dist$group)
#write.csv(mat, file="~/Documents/git/regionalrisk/analyses/output/matpredict.csv", row.names=FALSE)
#mat<-read.csv("~/Documents/git/regionalrisk/analyses/output/matpredict.csv", header=TRUE)
#mat$group<-as.character(mat$group)
mat.p<- ggplot(mat, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Mean Spring Temperature") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
dist.p
View(dist)
read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
dist$group<-as.character(dist$group)
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
#write.csv(nao, file="naopredict.csv", row.names=FALSE)
#nao<-read.csv("~/Documents/git/regionalrisk/analyses/output/naopredict.csv", header=TRUE)
#nao$group<-as.character(nao$group)
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
#elev$group<-as.character(elev$group)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#write.csv(mat, file="~/Documents/git/regionalrisk/analyses/output/matpredict.csv", row.names=FALSE)
#mat<-read.csv("~/Documents/git/regionalrisk/analyses/output/matpredict.csv", header=TRUE)
#mat$group<-as.character(mat$group)
mat.p<- ggplot(mat, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Mean Spring Temperature") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_bernsnewdvr.Rdata")
bernsnewdvr
summary(bernsnewdvr)
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_berndvrshort.Rdata")
berndvrshort
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_berndvrbigpriors.Rdata")
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_bernoldbigpriors.Rdata")
library(rstanarm)
library(brms)
bernoldbigpriors
berndvrbigpriors
# Started 16 Nov 2018
# By Cat based off Ailene's models_brms.R code
# Fitting bb models with brms to compare coefficients with stan models using different distributions
# housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
setwd("~/Documents/git/ospree/analyses/bb_analysis")
library(brms)
library(rstan)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
use.chillunits = FALSE # change to true for testing chill units
use.allspp = TRUE
source("source/bbstanleadin.R")
#range(bb.stan$resp)
bb.stan$respg<-bb.stan$resp+0.001
#uncentered gamma:
m2l.winsp.brms <- brm(respg ~ (force + photo + chill +#main effects
force*photo + force*chill + photo*chill)+ #interactions
((force + photo + chill + force*photo + force*chill + photo*chill)|complex.wname),warmup=2500,iter=4000, data = bb.stan,
chains = 2, cores = 2,control = list(max_treedepth = 12,adapt_delta = 0.99), family=Gamma("log"))
colnames(bb.stan)
colnames(bb.stan.allspp)
#uncentered gamma:
m2l.winsp.brms <- brm(respg ~ (force + photo + chill +#main effects
force*photo + force*chill + photo*chill)+ #interactions
((force + photo + chill + force*photo + force*chill + photo*chill)|complex.wname),warmup=2500,iter=4000, data = bb.stan.onecue,
chains = 2, cores = 2,control = list(max_treedepth = 12,adapt_delta = 0.99), family=Gamma("log"))
use.allspp = FALSE
source("source/bbstanleadin.R")
#uncentered gamma:
m2l.winsp.brms <- brm(respg ~ (force + photo + chill +#main effects
force*photo + force*chill + photo*chill)+ #interactions
((force + photo + chill + force*photo + force*chill + photo*chill)|complex.wname),warmup=2500,iter=4000, data = bb.stan.onecue,
chains = 2, cores = 2,control = list(max_treedepth = 12,adapt_delta = 0.99), family=Gamma("log"))
#range(bb.stan$resp)
bb.stan$respg<-bb.stan$resp+0.001
#range(bb.stan$resp)
bb.stan.onecue$respg<-bb.stan$resp+0.001
#range(bb.stan$resp)
bb.stan.onecue$respg<-bb.stan.onecue$resp+0.001
#uncentered gamma:
m2l.winsp.brms <- brm(respg ~ (force + photo + chill +#main effects
force*photo + force*chill + photo*chill)+ #interactions
((force + photo + chill + force*photo + force*chill + photo*chill)|complex.wname),warmup=2500,iter=4000, data = bb.stan.onecue,
chains = 2, cores = 2,control = list(max_treedepth = 12,adapt_delta = 0.99), family=Gamma("log"))
m2l.winsp.brms
#zscored gamma:
m2l.winsp.brms.cen<- brm(respg ~ (force.cen + photo.cen + chill.cen +#main effects
force.cen*photo.cen + force.cen*chill.cen + photo.cen*chill.cen)+ #interactions
((force.cen + photo.cen + chill.cen+force.cen*photo.cen + force.cen*chill.cen + photo.cen*chill.cen)|complex.wname), data = bb.stan.onecue,
chains = 2, cores = 2,control = list(max_treedepth = 12,adapt_delta = 0.99), family=Gamma("log"))
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_bernfullfive.Rdata")
bernfullfive
############ Model Output BB
brms<-as.data.frame(tidy(bernfullfive, prob = 0.5))
library(rstan)
library(brms)
library(ggplot2)
library(egg)
library(RColorBrewer)
library(sjmisc)
library(sjPlot)
library(ggeffects)
library(broom)
setwd("~/Documents/git/regionalrisk/analyses/output")
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
############ Model Output BB
brms<-as.data.frame(tidy(bernfullfive, prob = 0.5))
brms<-brms[2:54,]
brms$term<-gsub(".*b_","",brms$term)
brms<-as.data.frame(tidy(bernfullfive,robust = TRUE))
brms<-brms[2:47,]
brms$term<-gsub(".*b_","",brms$term)
brms$term<-gsub(".*r_species","",brms$term)
brms<-brms[!(brms$term=="sd_species__nao.z" | brms$term=="sd_species__mat.z" | brms$term=="sd_species__elev.z"
| brms$term=="sd_species__dist.z" | brms$term=="sd_species__space.z" | brms$term=="sd_species__cc.z" | brms$term=="sigma"),]
brms$species<-c(0,0,0,0,0,0, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 0,0,0,0,0)
brms$Jvar<-NA
brms$Jvar<-ifelse(brms$term=="nao.z", 11, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z", 10, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z", 9, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z", 8, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z", 7, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z", 6, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:cc.z", 5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:cc.z", 4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:cc.z", 3, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:cc.z", 2, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:cc.z", 1, brms$Jvar)
bb<-brms[(brms$species==0),]
cols <- colorRampPalette(brewer.pal(9,"Set1"))(7)
estimates<-c("NAO Index", "Mean Spring Temperature", "Distance from Coast", "Elevation", "Space Parameter", "Climate Change",
"NAO Index x \nClimate Change", "Mean Spring Temperature \nx Climate Change",
"Distance from Coast \nx Climate Change", "Elevation x \nClimate Change", "Space Parameter \nx Climate Change")
estimates<-rev(estimates)
regrisk.five<-ggplot(bb, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
#scale_colour_manual(name="Species", values=cols,
#                   labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
#                           "2"=expression(paste(italic("Alnus glutinosa"))),
#                          "3"=expression(paste(italic("Betula pendula"))),
#                         "4"=expression(paste(italic("Fagus sylvatica"))),
#                        "5"=expression(paste(italic("Fraxinus excelsior"))),
#                       "6"=expression(paste(italic("Quercus robur"))),
#                      "0"="Overall Effects"))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none") + coord_cartesian(ylim=c(1,11))
#scale_size_manual(values=c(3, 1, 1, 1, 1, 1, 1, 1, 1, 1), name="Species",
#                 labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
#                         "2"=expression(paste(italic("Alnus glutinosa"))),
#                        "3"=expression(paste(italic("Betula pendula"))),
#                       "4"=expression(paste(italic("Fagus sylvatica"))),
#                      "5"=expression(paste(italic("Fraxinus excelsior"))),
#                     "6"=expression(paste(italic("Quercus robur"))),
#                    "0"="Overall Effects"))
quartz()
regrisk.five
View(brms)
brms<-as.data.frame(tidy(bernfullfive,robust = TRUE), prob=0.5)
View(brms)
brms<-brms[2:47,]
brms$term<-gsub(".*b_","",brms$term)
brms$term<-gsub(".*r_species","",brms$term)
brms<-brms[!(brms$term=="sd_species__nao.z" | brms$term=="sd_species__mat.z" | brms$term=="sd_species__elev.z"
| brms$term=="sd_species__dist.z" | brms$term=="sd_species__space.z" | brms$term=="sd_species__cc.z" | brms$term=="sigma"),]
brms$species<-c(0,0,0,0,0,0, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 2,3,4,5,6, 0,0,0,0,0)
brms$Jvar<-NA
brms$Jvar<-ifelse(brms$term=="nao.z", 11, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,nao.z]", 8.9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[ALNGLU,nao.z]", 8.8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[BETPEN,nao.z]", 8.7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FAGSYL,nao.z]", 8.6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FRAEXC,nao.z]", 8.5, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[QUEROB,nao.z]", 8.4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z", 10, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,mat.z]", 7.9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[ALNGLU,mat.z]", 7.8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[BETPEN,mat.z]", 7.7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FAGSYL,mat.z]", 7.6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FRAEXC,mat.z]", 7.5, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[QUEROB,mat.z]", 7.4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z", 9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,elev.z]", 6.9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[ALNGLU,elev.z]", 6.8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[BETPEN,elev.z]", 6.7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FAGSYL,elev.z]", 6.6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FRAEXC,elev.z]", 6.5, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[QUEROB,elev.z]", 6.4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z", 8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,dist.z]", 6.9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[ALNGLU,dist.z]", 6.8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[BETPEN,dist.z]", 6.7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FAGSYL,dist.z]", 6.6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FRAEXC,dist.z]", 6.5, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[QUEROB,dist.z]", 6.4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z", 7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,space]", 5.9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[ALNGLU,space]", 5.8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[BETPEN,space]", 5.7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FAGSYL,space]", 5.6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FRAEXC,space]", 5.5, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[QUEROB,space]", 5.4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="cc.z", 6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[AESHIP,cc]", 4.9, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[ALNGLU,cc]", 4.8, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[BETPEN,cc]", 4.7, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FAGSYL,cc]", 4.6, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[FRAEXC,cc]", 4.5, brms$Jvar)
#brms$Jvar<-ifelse(brms$term=="[QUEROB,cc]", 4.4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="nao.z:cc.z", 5, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="mat.z:cc.z", 4, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="elev.z:cc.z", 3, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="dist.z:cc.z", 2, brms$Jvar)
brms$Jvar<-ifelse(brms$term=="space.z:cc.z", 1, brms$Jvar)
bb<-brms[(brms$species==0),]
cols <- colorRampPalette(brewer.pal(9,"Set1"))(7)
estimates<-c("NAO Index", "Mean Spring Temperature", "Distance from Coast", "Elevation", "Space Parameter", "Climate Change",
"NAO Index x \nClimate Change", "Mean Spring Temperature \nx Climate Change",
"Distance from Coast \nx Climate Change", "Elevation x \nClimate Change", "Space Parameter \nx Climate Change")
estimates<-rev(estimates)
regrisk.five<-ggplot(bb, aes(x=lower, xend=upper, y=Jvar, yend=Jvar, col=as.factor(species))) +
geom_vline(xintercept=0, linetype="dotted") + geom_point(aes(x=estimate, y=Jvar, col=as.factor(species), size=as.factor(species))) +
#scale_colour_manual(name="Species", values=cols,
#                   labels=c("1"=expression(paste(italic("Aesculus hippocastanum"))),
#                           "2"=expression(paste(italic("Alnus glutinosa"))),
#                          "3"=expression(paste(italic("Betula pendula"))),
#                         "4"=expression(paste(italic("Fagus sylvatica"))),
#                        "5"=expression(paste(italic("Fraxinus excelsior"))),
#                       "6"=expression(paste(italic("Quercus robur"))),
#                      "0"="Overall Effects"))+
geom_segment(arrow = arrow(length = unit(0.00, "npc"))) +
scale_y_discrete(limits = sort(unique(brms$term)), labels=estimates) +
xlab("Change in Number of False Springs") + ylab("") + theme_linedraw() +
theme(legend.text=element_text(size=5), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="sans"), legend.position = "none") + coord_cartesian(ylim=c(1,11))
regrisk.five
