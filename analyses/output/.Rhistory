axis.title.x = element_blank()) +
#axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula \n(DVR = 11 days)", "AESHIP" = "Aesculus \nhippocastanum \n(DVR = 11 days)",
"abALNGLU" = "Alnus glutinosa \n(DVR = 12 days)", "FAGSYL"="Fagus sylvatica \n(DVR = 8 days)",
"QUEROB"="Quercus robur \n(DVR = 7 days)", "zFRAEXC"="Fraxinus \nexcelsior \n(DVR = 7 days)")) +
ylab("Number of Years \nwith False Springs") + coord_cartesian(ylim=c(0,25)) +
#geom_hline(yintercept=7.66, linetype="dotted", col="black") +
#annotate("text", x = 5.75, y = 245, label = "Before 1984", family="Helvetica", size=3, fontface="bold") +
scale_alpha_manual(name="Climate Change", values=c(0.2, 0.7),
labels=c("0"="1951-1983", "1"="1984-2016")) +
ggtitle("C.") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
quartz()
ggarrange(budburst, tmin, falsespring, ncol=1, nrow=3)
tmin<- ggplot(plust, aes(x=species, y=Tmin, alpha=cc)) + geom_boxplot(aes(alpha=as.factor(cc), fill=as.factor(species), col=as.factor(species))) +
scale_fill_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"abALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
scale_color_manual(name="Species", values=cols,
labels=c("aaBETPEN"=expression(paste(italic("Betula pendula"))),
"AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"abALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"QUEROB"=expression(paste(italic("Quercus robur"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))))) +
theme(legend.text=element_text(size=7), legend.title = element_text(size=9), legend.background = element_rect(linetype="solid", color="grey", size=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text=element_text(family="Helvetica"),
legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
legend.key = element_rect(colour = "transparent", fill = "white"), #legend.position = "none",
plot.margin = unit(c(1.5,1.5,1.0,1.5), "lines"),
axis.title.x = element_blank(),
axis.text.x.bottom = element_blank(), axis.ticks.x = element_blank()) + # top, right, bottom, left
scale_y_continuous(expand = c(0, 0)) +
scale_x_discrete(labels=c("aaBETPEN" = "Betula pendula", "AESHIP" = "Aesculus \nhippocastanum",
"abALNGLU" = "Alnus glutinosa", "FAGSYL"="Fagus sylvatica",
"QUEROB"="Quercus robur", "zFRAEXC"="Fraxinus \nexcelsior")) +
ylab("Minimum Temperature \nfrom Budburst to Leafout") + coord_cartesian(ylim=c(-5,20)) +
geom_hline(yintercept=7.69, linetype="dotted", col="black") +
#annotate("text", x = 5.75, y = 245, label = "Before 1984", family="Helvetica", size=3, fontface="bold") +
scale_alpha_manual(name="Climate Change", values=c(0.2, 0.7),
labels=c("0"="1951-1983", "1"="1984-2016")) +
ggtitle("B.") +
guides(alpha=guide_legend(override.aes=list(fill=hcl(c(15,195),100,0,alpha=c(0.2,0.7)))), col=FALSE, fill=FALSE)
ggarrange(budburst, tmin, falsespring, ncol=1, nrow=3)
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_bernsshort.Rdata")
bernsshort
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_bernsfinal.Rdata")
bernsfinal
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/analyses/scripts/zarchive/elevdist_bernsnewdvr.Rdata")
bernsnewdvr
##############################################################################################################
# Script to:
#' * Easy approach to generate maps w/wo ocean background
#'
#'  Ignacio Morales-Castilla
##############################################################################################################
rm(list=ls())
library(ggmap)
library(ggplot2)
library(rworldmap)
library(maps)
library(mapdata)
library(marmap)
library(dplyr)
library(tidyr)
library(egg)
library(RColorBrewer)
library(raster)
library(maptools)
library(ggplotify)
##Simple approach
## map without background
mapDevice() #create world map shaped window
map("world", fill=TRUE
,col="grey65"
,boundary=F,interior=F
,ylim=c(-60, 65), mar=c(0,0,0,0)
,projection='albers',par=c(0,0),wrap=T
,resolution=1,border="lightgrey",myborder=0)
## map with blue background
map("world", fill=TRUE
,col="grey65"
,bg="deepskyblue4"
,boundary=F,interior=F
,ylim=c(30, 65),xlim=c(-5,35), mar=c(0,0,0,0)
,projection='albers',par=c(0,0),wrap=T
,resolution=0,border="white",myborder=0)
#Using GGPLOT, plot the Base World Map
mapWorld <- borders("world", colour="gray72", fill="gray65",ylim=c(30,70),xlim=c(-10,35)) # create a layer of borders
site<-d%>%dplyr::select(lat, long, space)
site<-site[!duplicated(site),]
mp <- ggplot(site, aes(x=long, y=lat, color=space)) +   mapWorld +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))
mp + theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) + geom_point(aes(color=space)) + geom_jitter()
setwd("~/Documents/git/regionalrisk/analyses")
d<-read.csv("output/BBdata_dvr.csv", header=TRUE)
d<-d[(d$bb>=0),]
d$bb.space<-ave(d$bb, d$PEP_ID, d$species)
#Using GGPLOT, plot the Base World Map
mapWorld <- borders("world", colour="gray72", fill="gray65",ylim=c(30,70),xlim=c(-10,35)) # create a layer of borders
site<-d%>%dplyr::select(lat, long, bb.space, species)
site<-site[!duplicated(site),]
myPalette <- colorRampPalette(rev(brewer.pal(11, "Spectral")))
sc <- scale_colour_gradientn(colours = myPalette(100), limits=c(30, 168))
a.site<-filter(site, species=="AESHIP")
boundars<-readShapeSpatial("~/Documents/git/regionalrisk/analyses/input/natural_earth_vector/50m_cultural/ne_50m_admin_0_countries.shp")
mapWorld<-fortify(boundars)
aes <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +
geom_jitter(width=3,aes(x=a.site$long, y=a.site$lat, color=a.site$bb), size=0.8, alpha=0.4) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
#legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) +
annotate("text",label= "Aesculus \nhippocastanum", col="gold2", x=-12, y=68,fontface="bold.italic", size=3,
family="Helvetica", hjust=0) + sc +
labs(color="Day of Budburst") + ggtitle("C.")
spg<-a.site
coordinates(spg)<- ~long+lat
proj4string(spg)<-CRS("+proj=longlat +datum=WGS84")
coords<-spTransform(spg, CRS("+proj=longlat"))
shapefile(coords, "output/aeship_dvr.shp")
ag.site<-filter(site, species=="ALNGLU")
boundars<-readShapeSpatial("~/Documents/git/regionalrisk/analyses/input/natural_earth_vector/50m_cultural/ne_50m_admin_0_countries.shp")
mapWorld<-fortify(boundars)
aln <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +
geom_jitter(width=3,aes(x=ag.site$long, y=ag.site$lat, color=ag.site$bb), size=0.8, alpha=0.4) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill="grey95"),
legend.position = "none") +
annotate("text",label= "Alnus glutinosa", col="#CAB1C4", x=1, y=70,fontface="bold.italic", size=3,
family="Helvetica") + sc +
labs(color="Day of Budburst") + ggtitle("B.")
spg<-ag.site
coordinates(spg)<- ~long+lat
proj4string(spg)<-CRS("+proj=longlat +datum=WGS84")
coords<-spTransform(spg, CRS("+proj=longlat"))
shapefile(coords, "output/alnglu_dvr.shp")
b.site<-filter(site, species=="BETPEN")
boundars<-readShapeSpatial("~/Documents/git/regionalrisk/analyses/input/natural_earth_vector/50m_cultural/ne_50m_admin_0_countries.shp")
mapWorld<-fortify(boundars)
bet <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +
geom_jitter(width=3,aes(x=b.site$long, y=b.site$lat, color=b.site$bb), size=0.8, alpha=0.4) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) +
annotate("text",label= "Betula pendula", col="#7FC97F", x=0, y=70,fontface="bold.italic", size=3,
family="Helvetica") + sc +
labs(color="Day of Budburst") + ggtitle("C.")
b.site<-na.omit(b.site)
spg<-b.site
coordinates(spg)<- ~long+lat
proj4string(spg)<-CRS("+proj=longlat +datum=WGS84")
coords<-spTransform(spg, CRS("+proj=longlat"))
shapefile(coords, "output/betpen_dvr.shp", overwrite=TRUE)
f.site<-filter(site, species=="FAGSYL")
boundars<-readShapeSpatial("~/Documents/git/regionalrisk/analyses/input/natural_earth_vector/50m_cultural/ne_50m_admin_0_countries.shp")
mapWorld<-fortify(boundars)
syl <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +
geom_jitter(width=3,aes(x=f.site$long, y=f.site$lat, color=f.site$bb), size=0.8, alpha=0.4) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) +
annotate("text",label= "Fagus sylvatica", col="#87A6A6", x=0, y=70,fontface="bold.italic", size=3,
family="Helvetica") + sc +
labs(color="Day of Budburst") + ggtitle("D.")
spg<-f.site
coordinates(spg)<- ~long+lat
proj4string(spg)<-CRS("+proj=longlat +datum=WGS84")
coords<-spTransform(spg, CRS("+proj=longlat"))
shapefile(coords, "output/fagsyl_dvr.shp")
fe.site<-filter(site, species=="FRAEXC")
boundars<-readShapeSpatial("~/Documents/git/regionalrisk/analyses/input/natural_earth_vector/50m_cultural/ne_50m_admin_0_countries.shp")
mapWorld<-fortify(boundars)
fra <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +
geom_jitter(width=3,aes(x=fe.site$long, y=fe.site$lat, color=fe.site$bb), size=0.8, alpha=0.4) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) +
annotate("text",label= "Fraxinus excelsior", col="#BF5B17", x=3, y=70,fontface="bold.italic", size=3,
family="Helvetica") + sc +
labs(color="Day of Budburst") + ggtitle("F.")
spg<-fe.site
coordinates(spg)<- ~long+lat
proj4string(spg)<-CRS("+proj=longlat +datum=WGS84")
coords<-spTransform(spg, CRS("+proj=longlat"))
shapefile(coords, "output/fraexc_dvr.shp")
q.site<-filter(site, species=="QUEROB")
boundars<-readShapeSpatial("~/Documents/git/regionalrisk/analyses/input/natural_earth_vector/50m_cultural/ne_50m_admin_0_countries.shp")
mapWorld<-fortify(boundars)
que <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +
geom_jitter(width=3,aes(x=q.site$long, y=q.site$lat, color=q.site$bb), size=0.8, alpha=0.4) +
theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) +
annotate("text",label= "Quercus robur", col="#CB1788", x=0, y=70,fontface="bold.italic", size=3,
family="Helvetica") + sc +
labs(color="Day of Budburst") + ggtitle("E.")
quartz()
mappies<-ggarrange(bet, aln, aes, syl, que, fra, ncol=3, nrow=2)
bet <- ggplot() +
geom_polygon(aes(x = mapWorld$long, y = mapWorld$lat, group = mapWorld$group),
color = 'gray', fill="lightgrey", size = .2) +
geom_jitter(width=3,aes(x=b.site$long, y=b.site$lat, color=b.site$bb), size=0.8, alpha=0.4) + theme_classic() +
coord_cartesian(ylim=c(30,70),xlim=c(-10,35))+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
axis.title = element_blank(),
panel.background = element_rect(fill="grey95")) +
annotate("text",label= "Betula pendula", col="#7FC97F", x=0, y=70,fontface="bold.italic", size=3,
family="Helvetica") + sc +
labs(color="Day of Budburst") + ggtitle("A.")
mappies<-ggarrange(bet, aln, aes, syl, que, fra, ncol=3, nrow=2)
png("figures/BB_dvr.png",
width=8,
height=5, units="in", res = 350 )
grid.draw(mappies)
dev.off()
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load Libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(egg)
library(brms)
library(grid)
library(gridExtra)
# Setting working directory
setwd("~/Documents/git/regionalrisk/analyses/")
bb<-read.csv("output/fs_newdvr_space.csv", header=TRUE)
xx<-read.csv("output/BBdata_dvr.csv", header=TRUE)
xx$bb.avg<-ave(xx$bb, xx$species)
table(xx$species, xx$bb.avg)
pre<-xx[(xx$year<1984),]
pre$bb.avg<-ave(pre$bb, pre$species)
table(pre$species, pre$bb.avg)
foo<-read.csv("output/fs_space_new.csv", header=TRUE)
post<-xx[(xx$year>1983),]
post$bb.avg<-ave(post$bb, post$species)
table(post$species, post$bb.avg)
colnames(xx)
colnames(foo)
dxx<-bb
xx<-inner_join(xx, dxx)
xx$bb.yr<-ave(xx$bb, xx$species, xx$year)
pref<-xx[(xx$cc==0),]
pref$numfs<-ave(pref$fs.count, pref$species, FUN=sum)
postf<-xx[(xx$cc==1),]
postf$numfs<-ave(postf$fs.count, postf$species, FUN=sum)
table(pref$species, pref$numfs)
table(postf$species, postf$numfs)
rm(list=ls())
options(stringsAsFactors = FALSE)
library(ggplot2)
library(rstanarm)
library(dplyr)
library(tidyr)
library(brms)
library(jtools)
# Setting working directory
setwd("~/Documents/git/regionalrisk/analyses/")
dx<-read.csv("output/fs_space_new.csv", header=TRUE)
#xx<-read.csv("output/fs_yearsitespp.csv", header=TRUE)
#xx<-subset(xx, year>1950)
dx<-subset(dx, select=c("lat", "long", "lat.long", "eigen", "distkm", "elev", "mst", "nao", "year", "species", "cc"))
dx<-read.csv("output/fs_space_new.csv", header=TRUE)
buds<-read.csv("output/BBdata.csv", header=TRUE)
colnames(buds)
bb<-full_join(dx, buds)
bb<-bb[!duplicated(bb),]
bb<-na.omit(bb)
buds<-read.csv("output/BBdata.csv", header=TRUE)
buds<-dplyr::select(buds, -PEP_ID)
bb<-full_join(dx, buds)
bb<-bb[!duplicated(bb),]
bb<-na.omit(bb)
buds<-read.csv("output/BBdata.csv", header=TRUE)
buds<-dplyr::select(buds, -PEP_ID)
buds<-buds[!duplicated(buds),]
bb<-full_join(dx, buds)
bb<-bb[!duplicated(bb),]
bb<-na.omit(bb)
#bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_newdvr_space.csv", header=TRUE)
bb<-subset(bb, select=c("species", "lat", "elev", "year", "mst", "cc", "fs.count", "nao",
"distkm", "eigen", "bb"))
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$nao.z <- (bb$nao-mean(bb$nao,na.rm=TRUE))/(2*sd(bb$nao,na.rm=TRUE))
bb$mat.z <- (bb$mst-mean(bb$mst,na.rm=TRUE))/(2*sd(bb$mst,na.rm=TRUE))
bb$cc.z <- (bb$cc-mean(bb$cc,na.rm=TRUE))/(2*sd(bb$cc,na.rm=TRUE))
bb$elev.z <- (bb$elev-mean(bb$elev,na.rm=TRUE))/(2*sd(bb$elev,na.rm=TRUE))
bb$lat.z <- (bb$lat-mean(bb$lat,na.rm=TRUE))/(2*sd(bb$lat,na.rm=TRUE))
bb$dist.z <-(bb$distkm-mean(bb$distkm,na.rm=TRUE))/(2*sd(bb$distkm,na.rm=TRUE))
bb$space.z <-(bb$eigen-mean(bb$eigen,na.rm=TRUE))/(2*sd(bb$eigen,na.rm=TRUE))
bb$bb.z <-(bb$bb-mean(bb$bb,na.rm=TRUE))/(2*sd(bb$bb,na.rm=TRUE))
testbb<-glm(fs ~ bb.z + nao.z + mat.z + dist.z + elev.z + space.z +
cc.z + species + bb.z:species + nao.z:species +
mat.z:species + dist.z:species + elev.z:species + space.z:species + cc.z:species + bb.z:cc.z +
nao.z:cc.z + mat.z:cc.z + dist.z:cc.z + elev.z:cc.z + space.z:cc.z, data=bb,
family=binomial())
summary(testbb)
summary(glm(fs~bb, data=bb))
write.csv(bb, file="~/Documents/git/regionalrisk/analyses/output/fs_space_new.csv", row.names = FALSE)
rm(list=ls())
options(stringsAsFactors = FALSE)
library(ggplot2)
library(rstanarm)
library(dplyr)
library(tidyr)
library(brms)
library(jtools)
# Setting working directory
setwd("~/Documents/git/regionalrisk/analyses/")
dx<-read.csv("output/fs_space_new.csv", header=TRUE)
buds<-read.csv("output/BBdata.csv", header=TRUE)
buds<-dplyr::select(buds, -PEP_ID)
buds<-buds[!duplicated(buds),]
bb<-full_join(dx, buds)
bb<-bb[!duplicated(bb),]
bb<-na.omit(bb)
write.csv(bb, file="~/Documents/git/regionalrisk/analyses/output/fs_space_new_bb.csv", row.names = FALSE)
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/analyses/scripts/zarchive/elevdist_bernsnewdvr.Rdata")
############ Model Output
brms<-as.data.frame(tidy(bernsnewdvr,robust = TRUE))
rm(list=ls())
options(stringsAsFactors = FALSE)
## Libraries
library(rstan)
library(brms)
library(ggplot2)
library(egg)
library(RColorBrewer)
library(sjmisc)
library(sjPlot)
library(ggeffects)
library(broom)
setwd("~/Documents/git/regionalrisk/analyses/output")
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
############ Model Output
brms<-as.data.frame(tidy(bernsnewdvr,robust = TRUE))
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/analyses/scripts/zarchive/elevdist_bernsnewdvr.Rdata")
############ Model Output
brms<-as.data.frame(tidy(bernsnewdvr,robust = TRUE))
brms
############ Model Output
brms<-as.data.frame(tidy(bernsnewdvr,robust = TRUE, conf.level = 0.5))
brms
############ Model Output
brms<-as.data.frame(tidy(bernsnewdvr,conf.level = 0.5))
brms
############ Model Output
brms<-as.data.frame(confint_tidy(bernsnewdvr, robust=TRUE, conf.level = 0.5)) )
############ Model Output
brms<-as.data.frame(confint_tidy(bernsnewdvr, robust=TRUE, conf.level = 0.5))
############ Model Output
brms<-as.data.frame(confint_tidy(bernsnewdvr, conf.level = 0.5))
?confint_tidy
############ Model Output
brms<-as.data.frame(confint_tidy(bernsnewdvr, conf.level = 0.5))
############ Model Output
brms<-as.data.frame(tidy(bernsnewdvr, conf.level = 0.5))
?tidy
############ Model Output
brms<-as.data.frame(tidy(bernsnewdvr, prob = 0.5))
brms
dselect<-read.csv("~/Documents/git/regionalrisk/analyses/output/memselect.csv", header=TRUE)
bb<-read.csv("/n/wolkovich_lab/Lab/Cat/fs_newdvr_space.csv", header=TRUE)
bbs<-bb[!duplicated(bb$lat.long),]
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_newdvr_space.csv", header=TRUE)
bb$lat.long<-paste(bb$lat, bb$long)
bb$Y<-ave(bb$fs.count, bb$lat.long, FUN=sum)
bbs<-bb[!duplicated(bb$lat.long),]
dx<-cbind(bbs, dselect)
library(dplyr)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -distance, -space, -cc, -nao, -year)
colnames(dx)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -distance, -eigen, -cc, -nao, -year)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -eigen, -cc, -nao, -year)
rex.mod<-lm(fs.count~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
bb<-bb%>%dplyr::select(-space)
bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig, by="lat.long")
write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_dvr_cleaned.csv", row.names=FALSE)
rm(list=ls())
options(stringsAsFactors = FALSE)
library(ggplot2)
library(rstanarm)
library(dplyr)
library(tidyr)
library(brms)
library(jtools)
# Setting working directory
setwd("~/Documents/git/regionalrisk/analyses/")
dx<-read.csv("output/fs_space_new.csv", header=TRUE)
#xx<-read.csv("output/fs_yearsitespp.csv", header=TRUE)
#xx<-subset(xx, year>1950)
dx<-subset(dx, select=c("lat", "long", "lat.long", "eigen", "distkm", "elev", "mst", "nao", "year", "species", "cc"))
#xx<-read.csv("output/fs_yearsitespp_5.csv", header=TRUE)
xx<-read.csv("output/fs_dvr_cleaned.csv", header=TRUE)
xx<-subset(xx, select=c("lat", "long", "fs.count", "year", "species", "fs"))
bb<-full_join(dx, xx)
bb<-bb[!duplicated(bb),]
bb<-na.omit(bb)
write.csv(bb, file="~/Documents/git/regionalrisk/analyses/output/fs_newdvr_space.csv", row.names = FALSE)
rm(list=ls())
options(stringsAsFactors = FALSE)
## Libraries
library(rstan)
library(brms)
library(ggplot2)
library(egg)
library(RColorBrewer)
library(sjmisc)
library(sjPlot)
library(ggeffects)
library(broom)
setwd("~/Documents/git/regionalrisk/analyses/output")
cols <- colorRampPalette(brewer.pal(7,"Accent"))(6)
write.csv(naosp, file="~/Documents/git/regionalrisk/analyses/output/naosp_predicted_five.csv", row.names = FALSE)
#write.csv(naosp, file="~/Documents/git/regionalrisk/analyses/output/naosp_predicted_five.csv", row.names = FALSE)
naosp<-read.csv("~/Documents/git/regionalrisk/analyses/output/naosp_predicted_five.csv", header=TRUE)
naosp.p<-ggplot(naosp, aes(x=x, y=predicted))+ geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("A.") + theme_classic() + theme(legend.position = "none") +
scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4))+
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"BETPEN"=expression(paste(italic("Betula lenta"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"FRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"BETPEN"=expression(paste(italic("Betula lenta"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"FRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
quartz()
naosp.p
quartz()
